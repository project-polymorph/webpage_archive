<!DOCTYPE html>
<html><head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>
Articles    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- CSP -->
    <meta http-equiv="Content-Security-Policy" content="
      default-src 'self';
      style-src 'self' 'unsafe-inline';
      script-src 'self' 'unsafe-inline' 'unsafe-eval' https://hm.baidu.com https://tjs.sjs.sinajs.cn;
      img-src 'self' data: https://hm.baidu.com;
      font-src 'self' data:;
    ">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link href="/lib/font-awesome/css/font-awesome.min.css" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="/web/css/secondary.css?v=hlbXKGkDpIWyW5hxEoEpbUvq4AkCwfb6fe1mEPuclq8">
    <script src="https://hm.baidu.com/hm.js?0cef5635b9f74c4e0da1f91d8ec3e7cc"></script><script src="/res/js/jquery.min.js"></script>
    <link href="/res/css/bootstrap.min.css" rel="stylesheet">
    <script src="/res/js/bootstrap.min.js"></script>
    <link href="/lib/pear-admin-layui/component/layui/css/layui.css" rel="stylesheet">
    <script src="/lib/Pear-Admin-Layui/component/layui/layui.js?v=jww6pBWTQVWN7tlXgEuczFf75sxy0a6iI-ToWZS2R1c"></script>
    <script src="/lib/Pear-Admin-Layui/component/pear/pear.js?v=LyRzfo4O2-534iFmJw5fgnHnAP7NkEoM3BJQa4wMnhM"></script>
    <script src="/lib/abc/abc.js?v=aMdQOyhO3gbx46io06aO1i89p4NyM0vTBl9UPyYUX-w"></script>
    <script src="/js/jn.js?v=kOCuYCFQk_xU_1q8fZxybL8OhTL2_wSMEqRXqFBDfQA"></script>
    <!--[if lt IE 9]>
    <script src="/res/js/html5shiv.min.js"></script>
    <script src="/res/js/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" href="/res/css/reset.css?v=pTbmaH-UelOLaHR4R0ztWHFS2iITO7KiFymCObxqTB0">
    <link rel="stylesheet" href="/res/css/common.css?v=L3JWsmHJvIeE1qNFGyW1Wfqzz2gVw31Fm6uESZWEAyc">
    <link rel="stylesheet" href="/res/css/home.css?v=xooiRWKsW6djtgKV8NjJgB5zrOH3Tt5InMAQcSskb_c">
    <script src="/res/js/template.js"></script>
    <script src="/web/js/vyouke.js?v=g39PQFvx4kZAG93n230KlhFxjX8I4M1By7n51AFMr4g"></script>


    <script>
        abc.safeInit();
        var journal_type = '';
        if (journal_type == '') {
            journal_type = "all";
        }
    </script>
    <script src="/res/js/app.js?v=d9cd63b6-0054-456e-bc78-62d47d19ca9e"></script>
    <style>
        .mar_top2 img {
            height: 82px;
        }

        .js_tab {
            width: 49%;
            margin-top: 8px;
            margin-bottom: 6px;
        }
    </style>

    <script src="https://tjs.sjs.sinajs.cn/open/api/js/wb.js" type="text/javascript" charset="utf-8"></script>
<style id="pear-admin-color">.light-theme .pear-nav-tree .layui-this a:hover,.light-theme .pear-nav-tree .layui-this,.light-theme .pear-nav-tree .layui-this a,.pear-nav-tree .layui-this a,.pear-nav-tree .layui-this{background-color: null!important;}.pear-admin .layui-logo .title{color:null!important;}.pear-frame-title .dot,.pear-tab .layui-this .pear-tab-active{background-color: null!important;}.bottom-nav li a:hover{background-color:null!important;}.pear-admin .layui-header .layui-nav .layui-nav-bar{background-color: null!important;}.ball-loader>span,.signal-loader>span {background-color: null!important;}.layui-header .layui-nav-child .layui-this a{background-color:null!important;color:white!important;}#preloader{background-color:null!important;}.pearone-color .color-content li.layui-this:after, .pearone-color .color-content li:hover:after {border: null 3px solid!important;}.layui-nav .layui-nav-child dd.layui-this a, .layui-nav-child dd.layui-this{background-color:null;color:white;}.pear-social-entrance {background-color:null!important}.pear-admin .pe-collaspe {background-color:null!important}.layui-fixbar li {background-color:null!important}.pear-btn-primary {background-color:null!important}.layui-input:focus,.layui-textarea:focus {border-color: null!important;box-shadow: 0 0 0 3px null !important;}.layui-form-checked[lay-skin=primary] i {border-color: null!important;background-color: null;}.layui-form-onswitch { border-color: null; background-color: null;}.layui-form-radio>i:hover, .layui-form-radioed>i {color: null;}.layui-laypage .layui-laypage-curr .layui-laypage-em{background-color:null!important}.layui-tab-brief>.layui-tab-more li.layui-this:after, .layui-tab-brief>.layui-tab-title .layui-this:after{border-bottom: 3px solid null!important}.layui-tab-brief>.layui-tab-title .layui-this{color:null!important}.layui-progress-bar{background-color:null}.layui-elem-quote{border-left: 5px solid null}.layui-timeline-axis{color:null}.layui-laydate .layui-this{background-color:null!important}.pear-this,.pear-text{color:null!important}.pear-back{background-color:null!important}.pear-collasped-pe{background-color:null!important}.layui-form-select dl dd.layui-this{color:null!important;}.tag-item-normal{background:null!important}.step-item-head.step-item-head-active{background-color:null}.step-item-head{border: 3px solid null;}.step-item-tail i{background-color:null}.step-item-head{color:null}div[xm-select-skin=normal] .xm-select-title div.xm-select-label>span i {background-color:null!important}div[xm-select-skin=normal] .xm-select-title div.xm-select-label>span{border: 1px solid null!important;background-color:null!important}div[xm-select-skin=normal] dl dd:not(.xm-dis-disabled) i{border-color:null!important}div[xm-select-skin=normal] dl dd.xm-select-this:not(.xm-dis-disabled) i{color:null!important}div[xm-select-skin=normal].xm-form-selected .xm-select, div[xm-select-skin=normal].xm-form-selected .xm-select:hover{border-color:null!important}.layui-layer-btn a:first-child{border-color:null;background-color:null!important}.layui-form-checkbox[lay-skin=primary]:hover i{border-color:null!important}.pear-tab-menu .item:hover{background-color:null!important}.layui-form-danger:focus {border-color:#FF5722 !important}.pear-admin .user .layui-this a:hover{color:white!important}.pear-notice .layui-this{color:null!important}.layui-form-radio:hover *, .layui-form-radioed, .layui-form-radioed>i{color:null !important}.pear-btn:hover {color: null;background-color: null;}.pear-btn-primary[plain] {color: null !important;background: null !important;}.pear-btn-primary[plain]:hover {background-color: null!important}.light-theme .pear-nav-tree .layui-this a:hover,.light-theme .pear-nav-tree .layui-this,.light-theme .pear-nav-tree .layui-this a {background-color:null!important;color:null!important;}.light-theme .pear-nav-tree .layui-this{ border-right: 3px solid null!important}.loader:after {background:null}</style></head>

<body style="background:#fff;position: relative;min-width:1280px;">

    <input name="__RequestVerificationToken" type="hidden" value="CfDJ8MmisOYVywlAsb9BO-nCrJ5fzjupIUtKkMcfdSdrGaMg35B33t3qJHoy44xHMD5eejvyqyiEYCxfUkN94ScplKIjCXDh94A_rutp4BtumFw1L9Ac7L3H9zXSs7a4ZqtfddyH2f7XdBmh4BE-mDWk-tU">
    <!--头部-->
    <div class="header-2">
    <div class="logo" style="padding-left:20px;">
        <a href="/">
            <img src="/res/images/logo.png" onerror="this.src='/res/images/logo.png'">
        </a>
    </div>
    <div class="search">
      <div class="type  search-types">
            <div class="no" data-type="article" id="articleSearchBtn"><span>Articles</span></div>
            <div class="" data-type="journal" id="journalSearchBtn"><span>Journals</span></div>
            </div>
            <div id="articleSearch" style="">
                <div class="box no" style="display:flex">
                    <div class="select">
                        <select id="search-article-type">
                        <option value="ZT">Topic</option>
                        <option value="pgz">Title &amp; Keywords &amp; Abstract</option>
                        <option value="TI">Title</option>
                        <option value="KW">Keywords</option>
                        <option value="AB">Abstract</option>
                        <option value="AU">Author</option>
                        <option value="AF">Affiliation(s)</option>
                        </select>
                    </div>
                    <div class="input">
                    <input type="text" id="search-article-text" value="" placeholder="Please enter search term" onkeypress="if(event.keyCode==13) {GB.search(this)}">
                    </div>
                  
                </div>
                
              <div class="submit" onclick="HomeSearch.search(this)">
                <input type="submit" name="" value="Search">
                    </div>
                <div class="submit">
                <span onclick="showAdvancedSearch()">Advanced</span>
                </div>
            </div>
            <div id="journalSearch" style="display:none;">
                <div class="box no">
                    <div class="select">
                        <select id="search-journal-type">
                        <option value="zt">Topic</option>
                        <option value="name">Journal title</option>
                            <option value="issn">ISSN</option>
                            <option value="cn">CN</option>
                        <option value="organizer">Organizer</option>
                        <option value="all">All</option>
                        </select>
                    </div>
                    <div class="input">
                    <input type="text" id="search-journal-text" value="" placeholder="Please enter search term" onkeypress="if(event.keyCode==13) {GB.search(this)}">
                    </div>
                </div>
                
                    <div class="submit" onclick="GB.search(this)">
                <input type="submit" name="" value="Search">
                    </div>
                <div class="submit">
                <span onclick="showAdvancedSearch()">Advanced</span>
                </div>
            </div>

    </div>
</div>



    <!--导航-->
    
<script>
    //百度统计3
    var _hmt = _hmt || [];
    (function () {
        console.log("百度统计3")
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?0cef5635b9f74c4e0da1f91d8ec3e7cc";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>
<div class="navbar site-nav">
    <div class="container">
        <div class="row">
            <div class="navbar-header">
                <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand visible-xs" href="/" style="padding-left:20px;">Peking University Journal Platform</a>
            </div>
            <div class="navbar-collapse collapse" role="navigation" style="display:flex;justify-content:space-between;">
                <div>
                    <ul class="nav navbar-nav">
                        <li class=""><a href="/Home/index">Home</a></li>
                        <li class=""><a href="/journal/index">Journals</a></li>
                        <li class="find_nav"><a href="/Search/search">Articles</a></li>
                        <li class=""><a href="/Home/about">About</a></li>
                    </ul>
                </div>
                <div style="    display: flex;
    justify-content: right;">

                        <div>

                            <a class="register" href="/account/register">Registration</a>
                            <div class="span"></div>
                            <a class="login" href="/account/login">Login</a>
                        </div>

                    <div style="min-width:100px;font-size: 14px;color:white;display:flex;align-items:center;position:relative;cursor:pointer;">
                            <div>  <span style="margin:auto 5px">|</span>  <span id="language" onclick="SetCulture('zh-CN')">中文(简体)</span></div>
                      
                        
                    </div>
                </div>


            </div>
        </div>
    </div>
</div>
 

<script src="/res/js/bootstrap.min.js"></script>
<script src="/res/js/bootstrap-select.js"></script>
<style>
    .languageItem {
        padding: 5px;
        font-size: 16px;
        text-align: center;
    }

        .languageItem:hover {
            background-color: #9a0000;
            color: white;
            cursor: pointer;
        }
</style>
<script>
    function SetCulture(culture) {
        abc.post({
            url: "/Home/SetCulture", data: { culture: culture }
            , success: function (result) {
                window.location.reload();
            }
            , fail: function (result) { }
        });
    }
    function showSelect() {
        $("#languageSelect").show();
    }

    function hideSelect() {
        $("#languageSelect").hide();
    }

    $(function () {
        $("#language").mouseenter(function (event) {
            if ($("#languageSelect").is(':hidden')) {//判断菜单的状态
                $("#languageSelect").slideDown(300)//显示菜单
            }
        })
        $("#languageSelect").mouseleave(function (event) {//离开元素
            $("#languageSelect").slideUp(300)//隐藏菜单
        })
    })
</script>


<script>
    function outLogin() {
        abc.post({
            url: "/account/LoginOut", done: function () {
                window.location.href = "/user/info";
            }
        });
    }
</script>

    <!--导航end-->
    <!-- develop end -->
<style>
    .hl {
         color: red;
    }
</style>
<!--头部-->
<script language="javascript">
    function tabChange(obj, id) {
        var arrayli = obj.parentNode.getElementsByTagName("li"); //获取li数组
        var arrayul = document.getElementById(id).getElementsByTagName("ul"); //获取ul数组
        for (i = 0; i < arrayul.length; i++) {
            if (obj == arrayli[i]) {
                arrayli[i].className = "cli";
                arrayul[i].className = "";
            } else {
                arrayli[i].className = "";
                arrayul[i].className = "hidden";
            }
        }
    }
</script>
<style type="text/css">
    .tabbox {
        width: 400px;
        margin-top: 5px;
        margin-bottom: 5px
    }

    .tabmenu {
        width: 400px;
        height: 28px;
        border-left: 1px solid #CCC;
        border-top: 1px solid #ccc;
    }

        .tabmenu ul {
            margin: 0;
            padding: 0;
            list-style-type: none;
        }

        .tabmenu li {
            text-align: center;
            float: left;
            display: block;
            width: 99px;
            overflow: hidden;
            background-color: #f1f1f1;
            line-height: 27px;
            border-right: #ccc 1px solid;
            border-bottom: #ccc 1px solid;
            display: inline;
        }

        .tabmenu .cli {
            text-align: center;
            float: left;
            display: block;
            width: 99px;
            overflow: hidden;
            background-color: #fff;
            line-height: 27px;
            border-right: #ccc 1px solid;
            border-bottom: #fff 1px solid;
            display: inline;
            cursor: pointer;
            color: #c30000;
            font-weight: bold
        }

    #tabcontent {
        width: 399px;
        background-color: #fff;
        border-left: #CCC 1px solid;
        border-right: #CCC 1px solid;
        border-bottom: #CCC 1px solid;
        height: 65px;
    }

        #tabcontent ul {
            margin: 0;
            padding: 5px;
            list-style-type: none;
        }

        #tabcontent .hidden {
            display: none;
        }

    .wz_lb label {
        font-weight: normal;
    }

    .page_ul li {
        background: none;
        padding: 0;
    }
</style>
<script type="text/javascript">

    //function MandF(o,b) {
    //    if(typeof (o) != "undefined")
    //    {
    //        if (o.className == "more") {
    //            o.className = "oncik";
    //            b.style.display = 'block';
    //        }
    //        else {
    //            o.className = "more";
    //            b.style.display = 'none';
    //        }
    //    }
    //}

    function MandF(b, o) {
        if (typeof (o) != "undefined") {
            if (b.innerHTML == "More") {
                b.innerHTML = "Less";
                o.style.display = 'block';
            }
            else {
                b.innerHTML = "More";
                o.style.display = 'none';
            }
        }
    }
    function ViewMore(o, b) {
        if (typeof (o) != "undefined") {
            o.style.display = 'block';
        }
        //if (typeof (b) != "undefined") {
        b.style.display = 'none';
        //}
    }
    function ViewFewer(o, b) {
        if (typeof (o) != "undefined") {
            o.style.display = 'none';
        }
        if (typeof (b) != "undefined") {
            b.style.display = 'block';
        }
    }
    function Filter(o) {
        frmFilter.tp.value = o;
        var c = 0;
        var r = false;
        var a = document.forms[0];
        var b = frmFilter.getElementsByTagName("input");
        for (var i = 0; i < b.length; i++) {
            if (b[i].type == "checkbox") {
                if (b[i].checked) {
                    c += 1;
                }
            }
        }
        if (c == 0) {
            if (o == 0)
                layer.msg('Please select filter criteria!');
            else
                layer.msg('Please select exclusion criteria!');
            r = false;
        } else { r = true; }
        if (r) {
            frmFilter.submit();
        }
        return r;
    }



    $(document).ready(function() {
        //$('xa.detail').fancybox({
        //    'padding': 0,
        //    'hideOnContentClick': false,
        //    //'showCloseButton'	: false,
        //    'titleShow': false,
        //    'transitionIn': 'none',
        //    'transitionOut': 'none',
        //    'type': 'iframe',
        //    'autoDimensions': false,
        //    'width': 620,
        //    'height': 530
        //});

        (function() {
            var default_value = {
                "autoScale": false,
                "padding": 0,
                "hideOnContentClick": false,
                "titleShow": false,
                "transitionIn": "none",
                "transitionOut": "none",
                "type": "iframe",
                "autoDimensions": false,
                "width": 800,
                "height": 530
            }

            default_value.width = 800;
            default_value.height = 600;
            //$("a.btnnoimg").fancybox(default_value);
            //$("a.house r100").fancybox(default_value);
        })();
        /*
            $("#btnExport").click(function () {
                $.get("Export.aspx", function (data, status) {
                    //alert("数据：" + data + "\n状态：" + status);
                });
            });*/

    });
</script>
<script type="text/javascript">
    function rmvfc(id) {
        frmSch.rm.value = id;
        frmSch.submit();
    }
    function ford(o) {
        frmSch.ob.value = o;
        frmSch.submit()
    }
    function fcka(obj, cName) {
        var checkboxs = document.getElementsByName(cName);
        for (var i = 0; i < checkboxs.length; i++) {
            checkboxs[i].checked = obj.checked;
        }
    }
    function fexp() {
        var ids = "";
        var checkboxs = document.getElementsByName("chkitm");
        for (var i = 0; i < checkboxs.length; i++) {
            if (checkboxs[i].checked) {
                ids = ids + checkboxs[i].value + ",";
            }
        }
        frmExp.sltype.value = frmSch.sltype.value;
        frmExp.ckids.value = ids;
        if (ids != "") {
            frmExp.submit();
        }
        else {
            layer.msg('Please select the record to export！');
        }
    }
</script>
<div class="line30"></div>
<!--中间-->
<div class="container">
    <div class="row">
        <div class="col-lg-3 qikan-list-left">
            <ul class="expmenu"></ul>
            <script type="text/javascript">
                $(document).ready(function() {
                    /* 滑动/展开 */
                    $("ul.expmenu").on("click", "li > div.ejmenu", function() {
                        var arrow = $(this).find("span.arrow");
                        if (arrow.hasClass("up")) {
                            arrow.removeClass("up");
                            arrow.addClass("down");
                        } else if (arrow.hasClass("down")) {
                            arrow.removeClass("down");
                            arrow.addClass("up");
                        }
                        $(this).parent().find("ul.menu").slideToggle();
                    });
                });
            </script>
            <script language="JavaScript">
                                <!--//
                function ShowMenu(obj, n) {
                    var Nav = obj.parentNode;
                    if (!Nav.id) {
                        var BName = Nav.getElementsByTagName("ol");
                        var HName = Nav.getElementsByTagName("h2");
                        var t = 2;
                    } else {
                        var BName = document.getElementById(Nav.id).getElementsByTagName("span");
                        var HName = document.getElementById(Nav.id).getElementsByTagName(".ejmenu");
                        var t = 1;
                    }
                    for (var i = 0; i < HName.length; i++) {
                        HName[i].innerHTML = HName[i].innerHTML.replace("-", "+");
                        HName[i].className = "";
                    }
                    obj.className = "h" + t;
                    for (var i = 0; i < BName.length; i++) { if (i != n) { BName[i].className = "no"; } }
                    if (BName[n].className == "no") {
                        BName[n].className = "";
                        obj.innerHTML = obj.innerHTML.replace("+", "-");
                    } else {
                        BName[n].className = "no";
                        obj.className = "";
                        obj.innerHTML = obj.innerHTML.replace("-", "+");
                    }
                }

                function custom_tab(tab) {
                    $("#searchForm-customTab").val(tab);
                }

                //-->
            </script>
        </div>

        <div class="col-lg-9 qikan-list-right">
            <div class="j_qikan_list">

                <!-- develop 必引内容，不可删除，不可改动 -->

                <link rel="stylesheet" type="text/css" href="/res/css/lrtk.css">
                <script language="javascript" src="/res/js/manu.js"></script>
                <link rel="stylesheet" href="/res/css/colorbox.css">
                <script src="/res/js/jquery.colorbox.js"></script>
                <script language="javascript">
                    //文章图片显示隐藏用
                    function togthumb() {
                        $(".apwrap").toggleClass("hiden");
                        if ($('.apwrap').hasClass('hiden'))
                            $("#thumbtn").attr("src", "/images/sele_pic2.png");
                        else
                            $("#thumbtn").attr("src", "/images/sele_pic1.png");
                    }
                    //选中文章  文章块  变色
                    function hightlightrowaction(rowid) {
                        var thisrow = $("#" + rowid);
                        if ($(thisrow).hasClass("selectedrow")) {
                            $(thisrow).removeClass("selectedrow");
                            $(thisrow).addClass("noselectrow");
                        } else {
                            $(thisrow).addClass("selectedrow");
                            $(thisrow).removeClass("noselectrow");
                        }
                    }

                    function selectall(argu, checkBoxName) {
                        var obj = document.getElementsByName(checkBoxName);
                        for (var i = 0; i < obj.length; i++) {
                            obj[i].checked = argu.checked;
                            //hightlightrowaction('art'+obj[i].value);
                            var thisrow = $("#art" + obj[i].value);
                            if (obj[i].checked) {
                                if (!$(thisrow).hasClass("selectedrow")) {
                                    $(thisrow).addClass("selectedrow");
                                    $(thisrow).removeClass("noselectrow");
                                }
                            } else {
                                if ($(thisrow).hasClass("selectedrow")) {
                                    $(thisrow).removeClass("selectedrow");
                                    $(thisrow).addClass("noselectrow");
                                }
                            }
                        }
                    }

                    function downloadCitations(type) {
                        var flag = 0;
                        var ids = "";
                        var obj = document.getElementsByName('pid');
                        for (var i = 0; i < obj.length; i++) {
                            if (obj[i].checked) {
                                flag = 1;
                                ids += obj[i].value + ",";
                            }
                        }
                        if (flag == 0) {
                            mag_layer({ content: "Please select an article!" });
                            return false;
                        }
                        window.location.href = "../article/getTxtFiles.do?fileType=" + type + "&articleIds=" + ids;
                    }
                    function DrawImage(ImgD, FitWidth, FitHeight) {
                        var image = new Image();
                        image.src = ImgD.src;
                        if (image.width > 0 && image.height > 0) {
                            if (image.width / image.height >= FitWidth / FitHeight) {
                                if (image.width > FitWidth) {
                                    ImgD.width = FitWidth;
                                    ImgD.height = (image.height * FitWidth) / image.width;
                                } else {
                                    ImgD.width = image.width;
                                    ImgD.height = image.height;
                                }
                            } else {
                                if (image.height > FitHeight) {
                                    ImgD.height = FitHeight;
                                    ImgD.width = (image.width * FitHeight) / image.height;
                                } else {
                                    ImgD.width = image.width;
                                    ImgD.height = image.height;
                                }
                            }
                        }
                    }
                    $(document).ready(function() {
                        //$(".figureClass").colorbox({ rel: 'figureClass', transition: "none", width: "80%", height: "80%" });

                    });

                    //可视化开始
                    $(document).ready(function() {
                        var arrSpan = $("[id^='span_visual_article_']");
                        if (arrSpan && arrSpan.length && arrSpan.length > 0) {
                            for (var i = 0; i < arrSpan.length; i++) {
                                var articleID = arrSpan[i].id.toString().replace("span_visual_article_", "");
                                jQuery.getJSON("/CN/lexeme/existsCnctstInArticle.do?articleID=" + articleID, null, function(json) {
                                    if (json.result) {
                                        $("#span_visual_article_" + json.articleID).show();
                                    }
                                });
                            }
                        }
                    });
                    //可视化结束

                    function collectArticle(id) {
                        var url = window.location.href;
                        jQuery.ajax({
                            url: "http://oaj.magtechjournal.com/CN/user/addCollectArticle.do",
                            data: {
                                "articleId": id,
                                "url": url
                            },
                            type: "post",
                            success: function(res) {
                                if (res == "true") {
                                    mag_layer({ content: "success！" });
                                } else if (res == "false") {
                                    mag_layer({ content: "Already added to your favoriate！" });
                                } else if (res.length > 5) {
                                    mag_layer({ content: "You need to log in to finish the operation.." });
                                } else {
                                    mag_layer({ content: "failed！" });
                                }
                            },
                            error: function() {
                                mag_layer({ content: "failed！" });
                            }
                        });
                    }

                </script>
                <style type="text/css">
                    .black_overlay {
                        display: none;
                        position: absolute;
                        top: 0%;
                        left: 0%;
                        width: 100%;
                        height: 100%;
                        background-color: #D8D8D8;
                        z-index: 1001;
                        -moz-opacity: 0.8;
                        opacity: .80;
                        filter: alpha(opacity=80);
                    }

                    .waiting_content {
                        display: none;
                        width: 50%;
                        padding: 16px;
                        border: 1px solid orange;
                        background-color: white;
                        z-index: 1002;
                        overflow: auto;
                        position: absolute; /**绝对定位**/
                        left: 50%; /**左边50%**/
                        top: 50%; /**顶部50%**/
                        margin-top: -50px; /**上移-50%**/
                        margin-left: -100px; /**左移-50%**/
                    }

                    .hiden {
                        display: none;
                    }
                </style>
                <div id="waiting" class="waiting_content">
                    <div style="padding: 10px;">
                        <span id="waitingInfo">Please wait a minute...</span><br>
                    </div>
                </div>
                <!-- develop end -->

                <div class="top_fenlei">
                    <div>
                        <div class="qk_count" style="width:100%;margin-bottom: 5px;" id="filterBox">Advanced： <b>作者</b>("%e6%a2%81%e6%9d%b0")<img src="/res/images/rmv.gif" style="cursor:pointer;vertical-align:middle" onclick="javascript:app.article.removeFilter(0)"></div>
                        <div style="margin-bottom: 5px;">Found <span class="blue-color red" id="total"><span title="0">0</span></span> results</div>
                    </div>
                    <div>
                        <div style="float:left;margin-right:3%;">
                            <input type="checkbox" id="allcheckbox" onclick="allselect()"> <span>All</span><span style="margin-left:10px;">Selected：</span><span id="selectcount">0</span>
                        </div>
                        <div style="float:left;margin-right:3%;">
                            <input type="button" onclick="ListCollectlistArticle()" style="margin-top:0px;width: 74px;
    border: solid #d9534f 1px;
    border-radius: 20px;    background-color: #d9534f;
    color: white;" value="Add all">
                        </div>
                        <div style="float:left;margin-right:3%;">
                            <input type="button" onclick="ListCancelCollectlistArticle()" style="margin-top:0px;width: 103px;
    border: solid #d9534f 1px;
    border-radius: 20px;    background-color: #d9534f;
    color: white;" value="Cacel all">
                        </div>
                        <div class="qk_shxu" style="margin:2px;">Sort by：<span class="red" style="margin:0px 5px 0px 0px;">Relevance<i class="fa fa-long-arrow-down" aria-hidden="true"></i></span><span style="cursor:pointer;margin:0px 5px 0px 0px;" onclick="javascript:app.article.sortArticle(1,2);">Publish Time </span><span style="cursor:pointer" onclick="javascript:app.article.sortArticle(2,2);">Title</span></div>
                        <div class="qk_type">
                            <ul class="nav nav-tabs" role="tablist">
                                <li role="presentation" class="active" onclick="custom_tab(0);"><a href="#tu" role="tab" data-toggle="tab"><i class="fa fa-calendar" aria-hidden="true"></i> table mode</a></li>
                                <li role="presentation" onclick="custom_tab(1);"><a href="#wenzi" role="tab" data-toggle="tab"><i class="fa fa-list-ul" aria-hidden="true"></i>Detail </a></li>
                            </ul>
                        </div>
                    </div>

                </div>

                <div class="tab-content">
                    <!--超过最大限制页数提示-->
                    <div style="color: rgb(148, 7, 10); font-size: 20px; padding: 50px; display: none;" id="warning_text"></div>
                    <!--标题列表-->
                    <div role="tabpanel" class="tab-pane active" id="tu"><div style="padding: 50px;text-align: center;color: #d9534f;">There are currently no relevant records</div></div>
                    <!--标题列表end-->
                    <!--文章详细列表-->
                    <div role="tabpanel" class="tab-pane" id="wenzi"><div style="padding: 50px;text-align: center;color: #d9534f;">There are currently no relevant records</div></div>
                    <!--文章详细列表end-->
                </div>

                <!-- 分页 -->
                <div class="page_list_box">
                </div>
            </div>
        </div>
    </div>
</div>
<!--底部-->

<script>
    var app = {
        init: function() {
            // this.article.init();

            if ('df' == "dd") { 
            
            this.article.sortArticle(1,1);
            }else
            {
            
            this.article.sortArticle(0);
            
            }
            this.article.updateFilter();
        },
        article: {
            searchModel: 'senior',//查询类型 ordinary普通搜索，senior高级搜索
            keyword: '',//简单查询关键词
            size: 20,
            page: 1,
            sort: 'df',//df相关度，dd时间降序，da时间升序
            sortFiled: "",
            facetFields: [{"Name":"AU","Desc":"作者","Type":"AND","IsAccurate":"0","Con":["%e6%a2%81%e6%9d%b0"],"JournalName":null,"Advanced":true}],//限制条件 new{ name="YS", desc="出版年度", type="AND",con="2020" }
            searchData: [],//结果集
            allAUName: [],
            init: function() {
                alert(app.article.sort)
                abc.get({
                    url: "/Search/searchbysolr", data: {
                        key: app.article.keyword,
                        size: app.article.size,
                        page: app.article.page,
                        sort: app.article.sort,
                        sortFiled: app.article.sortFiled,
                        facetFields: app.article.facetFields
                    }, success: function(res) {

                        var aids = [];
                        res.List.map(function(item, index) {
                            aids.push(item.Id);
                        })
                        abc.post({
                            url: '/article/getListArticleCollectStatus', data: { aids: aids }
                            , success: function(data) {
                                if (data.Data.length > 0) {

                                    data.Data.map(function(t, i) {
                                        res.List.find((item, index) => {
                                            return item.Id == t.id;
                                        }).isCollection = t.isCollection;
                                    })
                                }

                                app.article.searchData = res;
                                app.article.initFields(res);
                                app.article.initArticle(res);
                                app.article.initPages(res);
                            }
                        });


                    }
                });

                ////初始化获取数据
                //$.ajax({
                //    type: "POST",
                //    url: "/Search/searchbysolr",
                //    data: {
                //         key: app.article.keyword,
                //         size: app.article.size,
                //         page:app.article.page,
                //         sort:app.article.sort,
                //         facetFields:app.article.facetFields
                //    },
                //    dataType: "json",
                //    success: function(res) {
                //        app.article.searchData = res;
                //        app.article.initFields(res);
                //        app.article.initArticle(res);
                //        app.article.initPages(res);
                //    }
                //});
            },
            initFields: function(res) {
                //左侧限制和排除条件展示
                var html = '';

                //出版年度 res.FacetFields.YR

                if (res.FacetFields.YS != null && res.FacetFields.YS.length > 0) {
                    html += '<li class="fenglei-list"><div class="ejmenu"><span class="label"> Year </span><span class="arrow up"></span></div><ul class="menu" style="display: block;"><div id="journalFilter">';
                    var html_s = '';
                    var html_m = '';
                    res.FacetFields.YS.map(function(item, i) {
                        if (item.Key != null && item.Key != 'null' && item.Key.length > 0) {
                            if (i < 6) {
                                html_s += '<tr class="wz_lb" valign="top">' +
                                    '<td style="padding-right:5px"><input id="YR_' + i + '" name="fc_YR" value="' + app.article.yearFormat(item.Key) + '" type="checkbox"></td>' +
                                    '<td style="width:100%"><span><label for="YR_' + i + '"> ' + app.article.yearFormat(item.Key) + ' </label></span></td>' +
                                    '<td nowrap="true" style="padding-left:20px" align="right" title="'+Number(item.Value).toLocaleString()+'"> ' +jn.numberToString( item.Value) + ' articles</td></tr>';
                            } else {
                                html_m += '<tr class="wz_lb" valign="top">' +
                                    '<td style="padding-right:5px"><input id="YR_' + i + '" name="fc_YR" value="' + app.article.yearFormat(item.Key) + '" type="checkbox"></td>' +
                                    '<td style="width:100%"><span><label for="YR_' + i + '"> ' + app.article.yearFormat(item.Key) + ' </label></span></td>' +
                                    '<td nowrap="true" style="padding-left:20px" align="right" title="' + Number(item.Value).toLocaleString() + '"> ' + jn.numberToString(item.Value) + ' articles</td></tr>';
                            }
                        }
                    });
                    html += '<table width="100%" border="0" align="center" cellpadding="0" cellspacing="1" style="margin-top: 3px" id="journalFilterTable"><tbody>' + html_s + '</tbody></table>';
                    if (html_m != '') {
                        html += '<table id="ul_YR" style="display:none" width="100%" border="0" align="center" cellpadding="0" cellspacing="1"><tbody>' + html_m + '</tbody></table>';
                    }
                    html += '<table border="0"><tbody><tr class="wz_lbx"><td width="300" height="32" align="left">';
                    if (html_m != '') {
                        html += '<a id="H_YR" class="btn btn-default btn-xs" href="javascript:MandF(H_YR,ul_YR);">More</a>';
                    }
                    html += '</td><td><a class="label label-warning" onclick="javascript:app.article.filter(0,\'YR\',\'Year\',this);">Limit</a></td><td style="padding-left:5px"><a class="label label-danger" onclick="javascript:app.article.filter(1,\'YR\',\'Year\',this);">Exclude</a></td></tr></tbody></table>';

                    html += '</div></ul></li>';
                }


                //作者 res.FacetFields.AS
                if (res.FacetFields.AS != null && res.FacetFields.AS.length > 0) {
                    html += '<li class="fenglei-list"><div class="ejmenu"><span class="label"> Author </span><span class="arrow up"></span></div><ul class="menu" style="display: block;"><div id="journalFilter">';

                    var html_s = '';
                    var html_m = '';
                    res.FacetFields.AS.map(function(item, i) {
                        if (item.Key != null && item.Key != 'null' && item.Key.length > 0) {
                            if (i < 6) {
                                html_s += '<tr class="wz_lb" valign="top">' +
                                    '<td style="padding-right:5px"><input id="AS_' + i + '" name="fc_AS" value="' + item.Key + '" type="checkbox"></td>' +
                                    '<td style="width:100%"><span><label for="AS_' + i + '"> ' + item.Key + ' </label></span></td>' +
                                    '<td style="padding-left:20px" nowrap="true" align="right" title="' + Number(item.Value).toLocaleString() + '"> ' + jn.numberToString(item.Value )+ ' articles</td></tr>';
                            } else {
                                html_m += '<tr class="wz_lb" valign="top">' +
                                    '<td style="padding-right:5px"><input id="AS_' + i + '" name="fc_AS" value="' + item.Key + '" type="checkbox"></td>' +
                                    '<td style="width:100%"><span><label for="AS_' + i + '"> ' + item.Key + ' </label></span></td>' +
                                    '<td style="padding-left:20px" nowrap="true" align="right" title="' + Number(item.Value).toLocaleString() + '"> ' + jn.numberToString(item.Value) + ' articles</td></tr>';
                            }
                        }
                    });
                    html += '<table width="100%" border="0" align="center" cellpadding="0" cellspacing="1" style="margin-top: 3px" id="journalFilterTable"><tbody>' + html_s + '</tbody></table>';
                    if (html_m != '') {
                        html += '<table id="ul_AS" style="display:none" width="100%" border="0" align="center" cellpadding="0" cellspacing="1"><tbody>' + html_m + '</tbody></table>';
                    }
                    html += '<table border="0"><tbody><tr class="wz_lbx"><td width="300" height="32" align="left">';
                    if (html_m != '') {
                        html += '<a id="H_AS" class="btn btn-default btn-xs" href="javascript:MandF(H_AS,ul_AS);">More</a>';
                    }
                    html += '</td><td><a class="label label-warning" onclick="javascript:app.article.filter(0,\'AS\',\'Author\',this);">Limit</a></td><td style="padding-left:5px"><a class="label label-danger" onclick="javascript:app.article.filter(1,\'AS\',\'Author\',this);">Exclude</a></td></tr></tbody></table>';

                    html += '</div></ul></li>';
                }

                //文章类型 res.FacetFields.TP
                //去除key为空的元素
                res.FacetFields.TP.map(function(item, i) {
                    if (item.key == null || item.key == "null" || item.Key.length <= 0) {
                        res.FacetFields.TP.splice(i, 1);
                    }
                });
                if (res.FacetFields.TP != null && res.FacetFields.TP.length > 0) {
                    html += '<li class="fenglei-list"><div class="ejmenu"><span class="label"> Article Type </span><span class="arrow up"></span></div><ul class="menu" style="display: block;"><div id="journalFilter">';
                    var html_s = '';
                    var html_m = '';
                    res.FacetFields.TP.map(function(item, i) {
                        if (item.Key != null && item.Key != 'null' && item.Key.length > 0) {
                            if (i < 6) {
                                html_s += '<tr class="wz_lb" valign="top">' +
                                    '<td style="padding-right:5px"><input id="TP_' + i + '" name="fc_TP" value="' + item.Key + '" type="checkbox"></td>' +
                                    '<td style="width:100%"><span><label for="TP_' + i + '"> ' + item.Key + ' </label></span></td>' +
                                    '<td style="padding-left:20px" nowrap="true" align="right" title="' + Number(item.Value).toLocaleString() + '"> ' + jn.numberToString(item.Value) + ' articles</td></tr>';
                            } else {
                                html_m += '<tr class="wz_lb" valign="top">' +
                                    '<td style="padding-right:5px"><input id="TP_' + i + '" name="fc_TP" value="' + item.Key + '" type="checkbox"></td>' +
                                    '<td style="width:100%"><span><label for="TP_' + i + '"> ' + item.Key + ' </label></span></td>' +
                                    '<td style="padding-left:20px" nowrap="true" align="right" title="' + Number(item.Value).toLocaleString() + '"> ' + jn.numberToString(item.Value) + ' articles</td></tr>';
                            }
                        }
                    });
                    html += '<table width="100%" border="0" align="center" cellpadding="0" cellspacing="1" style="margin-top: 3px" id="journalFilterTable"><tbody>' + html_s + '</tbody></table>';
                    if (html_m != '') {
                        html += '<table id="ul_TP" style="display:none" width="100%" border="0" align="center" cellpadding="0" cellspacing="1"><tbody>' + html_m + '</tbody></table>';
                    }
                    html += '<table border="0"><tbody><tr class="wz_lbx"><td width="300" height="32" align="left">';
                    if (html_m != '') {
                        html += '<a id="H_TP" class="btn btn-default btn-xs" href="javascript:MandF(H_TP,ul_TP);">More</a>';
                    }
                    html += '</td><td><a class="label label-warning" onclick="javascript:app.article.filter(0,\'TP\',\'Article Type\',this);">Limit</a></td><td style="padding-left:5px"><a class="label label-danger" onclick="javascript:app.article.filter(1,\'TP\',\'Article Type\',this);">Exclude</a></td></tr></tbody></table>';

                    html += '</div></ul></li>';
                }

                //来源期刊 res.FacetFields.JC
                if (res.FacetFields.JC != null && res.FacetFields.JC.length > 0) {
                    html += '<li class="fenglei-list"><div class="ejmenu"><span class="label"> Journals </span><span class="arrow up"></span></div><ul class="menu" style="display: block;"><div id="journalFilter">';

                    var html_s = '';
                    var html_m = '';
                    res.FacetFields.JC.map(function(item, i) {
                        if (item.Key != null && item.Key != 'null' && item.Key.length > 0) {
                            if (i < 6) {
                                html_s += '<tr class="wz_lb" valign="top">' +
                                    '<td style="padding-right:5px"><input id="JC_' + i + '" name="fc_JC" value="' + item.Key + '" type="checkbox"></td>' +
                                    '<td style="width:100%"><span><label for="JC_' + i + '"> ' + item.Key + ' </label></span></td>' +
                                    '<td style="padding-left:20px" nowrap="true" align="right" title="' + Number(item.Value).toLocaleString() + '"> ' + jn.numberToString(item.Value) + ' articles</td></tr>';
                            } else {
                                html_m += '<tr class="wz_lb" valign="top">' +
                                    '<td style="padding-right:5px"><input id="JC_' + i + '" name="fc_JC" value="' + item.Key + '" type="checkbox"></td>' +
                                    '<td style="width:100%"><span><label for="JC_' + i + '"> ' + item.Key + ' </label></span></td>' +
                                    '<td style="padding-left:20px" nowrap="true" align="right" title="' + Number(item.Value).toLocaleString() + '"> ' + jn.numberToString(item.Value) + ' articles</td></tr>';
                            }
                        }
                    });
                    html += '<table width="100%" border="0" align="center" cellpadding="0" cellspacing="1" style="margin-top: 3px" id="journalFilterTable"><tbody>' + html_s + '</tbody></table>';
                    if (html_m != '') {
                        html += '<table id="ul_JC" style="display:none" width="100%" border="0" align="center" cellpadding="0" cellspacing="1"><tbody>' + html_m + '</tbody></table>';
                    }
                    html += '<table border="0"><tbody><tr class="wz_lbx"><td width="300" height="32" align="left">';
                    if (html_m != '') {
                        html += '<a id="H_JC" class="btn btn-default btn-xs" href="javascript:MandF(H_JC,ul_JC);">More</a>';
                    }
                    html += '</td><td><a class="label label-warning" onclick="javascript:app.article.filter(0,\'JC\',\'Journals\',this);">Limit</a></td><td style="padding-left:5px"><a class="label label-danger" onclick="javascript:app.article.filter(1,\'JC\',\'Journals\',this);">Exclude</a></td></tr></tbody></table>';
                    html += '</div></ul></li>';

                }

                //学科主题 res.FacetFields.SB
                if (res.FacetFields.SB != null && res.FacetFields.SB.length > 0) {
                    html += '<li class="fenglei-list"><div class="ejmenu"><span class="label">Subject  </span><span class="arrow up"></span></div><ul class="menu" style="display: block;"><div id="journalFilter">';

                    var html_s = '';
                    var html_m = '';
                    res.FacetFields.SB.map(function(item, i) {
                        if (item.Key != null && item.Key != 'null' && item.Key.length > 0) {
                            if (i < 6) {
                                html_s += '<tr class="wz_lb" valign="top">' +
                                    '<td style="padding-right:5px"><input id="SB_' + i + '" name="fc_SB" value="' + item.Key + '" type="checkbox"></td>' +
                                    '<td style="width:100%"><span><label for="SB_' + i + '"> ' + item.Key + ' </label></span></td>' +
                                    '<td style="padding-left:20px" nowrap="true" align="right" title="' + Number(item.Value).toLocaleString() + '"> ' + jn.numberToString(item.Value)+ ' articles</td></tr>';
                            } else {
                                html_m += '<tr class="wz_lb" valign="top">' +
                                    '<td style="padding-right:5px"><input id="SB_' + i + '" name="fc_SB" value="' + item.Key + '" type="checkbox"></td>' +
                                    '<td style="width:100%"><span><label for="SB_' + i + '"> ' + item.Key + ' </label></span></td>' +
                                    '<td style="padding-left:20px" nowrap="true" align="right" title="' + Number(item.Value).toLocaleString() + '"> ' + jn.numberToString(item.Value) + ' articles</td></tr>';
                            }
                        }
                    });
                    html += '<table width="100%" border="0" align="center" cellpadding="0" cellspacing="1" style="margin-top: 3px" id="journalFilterTable"><tbody>' + html_s + '</tbody></table>';
                    if (html_m != '') {
                        html += '<table id="ul_SB" style="display:none" width="100%" border="0" align="center" cellpadding="0" cellspacing="1"><tbody>' + html_m + '</tbody></table>';
                    }
                    html += '<table border="0"><tbody><tr class="wz_lbx"><td width="300" height="32" align="left">';
                    if (html_m != '') {
                        html += '<a id="H_SB" class="btn btn-default btn-xs" href="javascript:MandF(H_SB,ul_SB);">More</a>';
                    }
                    html += '</td><td><a class="label label-warning" onclick="javascript:app.article.filter(0,\'SB\',\'Subject\',this);">Limit</a></td><td style="padding-left:5px"><a class="label label-danger" onclick="javascript:app.article.filter(1,\'SB\',\'Subject\',this);">Exclude</a></td></tr></tbody></table>';

                    html += '</div></ul></li>';
                }

                //语种 res.FacetFields.LG
                if (res.FacetFields.LG != null && res.FacetFields.LG.length > 0) {
                    html += '<li class="fenglei-list"><div class="ejmenu"><span class="label"> Language </span><span class="arrow up"></span></div><ul class="menu" style="display: block;"><div id="journalFilter">';

                    var html_s = '';
                    var html_m = '';
                    res.FacetFields.LG.map(function(item, i) {
                        if (item.Key != null && item.Key != 'null' && item.Key.length > 0) {
                            if (i < 6) {
                                html_s += '<tr class="wz_lb" valign="top">' +
                                    '<td style="padding-right:5px"><input id="LG_' + i + '" name="fc_LG" value="' + item.Key + '" type="checkbox"></td>' +
                                    '<td style="width:100%"><span><label for="LG_' + i + '"> ' + item.Key + ' </label></span></td>' +
                                    '<td style="padding-left:20px" nowrap="true" align="right" title="' + Number(item.Value).toLocaleString() + '"> ' + jn.numberToString(item.Value) + ' articles</td></tr>';
                            } else {
                                html_m += '<tr class="wz_lb" valign="top">' +
                                    '<td style="padding-right:5px"><input id="LG_' + i + '" name="fc_LG" value="' + item.Key + '" type="checkbox"></td>' +
                                    '<td style="width:100%"><span><label for="LG_' + i + '"> ' + item.Key + ' </label></span></td>' +
                                    '<td style="padding-left:20px" nowrap="true" align="right" title="' + Number(item.Value).toLocaleString() + '"> ' + jn.numberToString(item.Value) + ' articles</td></tr>';
                            }
                        }
                    });
                    html += '<table width="100%" border="0" align="center" cellpadding="0" cellspacing="1" style="margin-top: 3px" id="journalFilterTable"><tbody>' + html_s + '</tbody></table>';
                    if (html_m != '') {
                        html += '<table id="ul_LG" style="display:none" width="100%" border="0" align="center" cellpadding="0" cellspacing="1"><tbody>' + html_m + '</tbody></table>';
                    }
                    html += '<table border="0"><tbody><tr class="wz_lbx"><td width="300" height="32" align="left">';
                    if (html_m != '') {
                        html += '<a id="H_LG" class="btn btn-default btn-xs" href="javascript:MandF(H_LG,ul_LG);">More</a>';
                    }
                    html += '</td><td><a class="label label-warning" onclick="javascript:app.article.filter(0,\'LG\',\'Language\',this);">Limit</a></td><td style="padding-left:5px"><a class="label label-danger" onclick="javascript:app.article.filter(1,\'LG\',\'Language\',this);">Exclude</a></td></tr></tbody></table>';
                    html += '</div></ul></li>';

                }

                //  //国别/地区 res.FacetFields.CT
                //if (res.FacetFields.CT!=null && res.FacetFields.CT.length > 0) {
                //       html += '<li class="fenglei-list"><div class="ejmenu"><span class="label"> 国别/地区 </span><span class="arrow up"></span></div><ul class="menu" style="display: block;"><div id="journalFilter">';

                //      var html_s = '';
                //      var html_m = '';
                //      res.FacetFields.CT.map(function(item,i) {
                //          if (item.Key != null &&item.Key != 'null' && item.Key.length > 0) {
                //              if (i<6) {
                //                  html_s += '<tr class="wz_lb" valign="top">' +
                //                      '<td style="padding-right:5px"><input id="CT_'+i+'" name="fc_CT" value="'+item.Key+'" type="checkbox"></td>' +
                //                      '<td style="width:100%"><span><label for="CT_'+i+'"> '+item.Key+' </label></span></td>' +
                //                      '<td style="padding-left:20px" nowrap="true" align="right"> '+item.Value+' articles</td></tr>';
                //              } else {
                //                  html_m += '<tr class="wz_lb" valign="top">' +
                //                      '<td style="padding-right:5px"><input id="CT_'+i+'" name="fc_CT" value="'+item.Key+'" type="checkbox"></td>' +
                //                      '<td style="width:100%"><span><label for="CT_'+i+'"> '+item.Key+' </label></span></td>' +
                //                      '<td style="padding-left:20px" nowrap="true" align="right"> '+item.Value+' articles</td></tr>';
                //              }
                //          }
                //      });
                //      html += '<table width="100%" border="0" align="center" cellpadding="0" cellspacing="1" style="margin-top: 3px" id="journalFilterTable"><tbody>'+ html_s + '</tbody></table>';
                //      if (html_m!='') {
                //          html += '<table id="ul_CT" style="display:none" width="100%" border="0" align="center" cellpadding="0" cellspacing="1"><tbody>'+ html_m + '</tbody></table>';
                //      }
                //      html += '<table border="0"><tbody><tr class="wz_lbx"><td width="300" height="32" align="left">';
                //      if (html_m!='') {
                //          html += '<a id="H_CT" class="btn btn-default btn-xs" href="javascript:MandF(H_CT,ul_CT);">更多</a>';
                //      }
                //      html += '</td><td><a class="label label-warning" onclick="javascript:app.article.filter(0,\'CT\',\'国别/地区\',this);">限定</a></td><td style="padding-left:5px"><a class="label label-danger" onclick="javascript:app.article.filter(1,\'CT\',\'国别/地区\',this);">排除</a></td></tr></tbody></table>';

                //  html += '</div></ul></li>';
                //  }

                $('.expmenu').html(html);
            },
            initArticle: function(res) {
                //文字列表展示
                $('#total').html('<span title="' + Number(res.Total).toLocaleString() + '">' + jn.numberToString(res.Total) + '</span>');
                if (res.List != null && res.List.length > 0) {
                    var html_table = '', html_list = '';

                    app.article.allAUName.length = 0;
                    res.List.map(function(item, i) {

                        //标题列表-复选框
                        html_table += '<tr><td>  <input name="checkbox" id="cb_' + item.Id + '" tag="' + item.Id + '" onclick="selectChecked(' + item.Id + ')" type="checkbox"/></td>';
                        //标题列表-标题
                        html_table += '<td><a href="/article/info?aid=' + item.Id + ' " target="_blank">' + item.TI + '</a></td><td><span class="abs_zuozhe_cn">';
                        //详情列表-复选框
                        html_list += '<dl style="float: left;margin-right:5px;"><dt><input name="checkbox" tag="' + item.Id + '" id="listcb_' + item.Id + '" onclick="listSelectChecked(' + item.Id + ')"  type="checkbox"/></dt></dl>';
                        //详情列表-文章标题
                        html_list += '<dl><dt><a href="/article/info?aid=' + item.Id+ '" target="_blank">' + item.TI + '</a><span class="abs_zuozhe_cn">';

                        //作者
                        if (item.AU2 != undefined && item.AU2 != null && item.AU2.length > 0) {
                            //var aulist=[];
                            //item.AU2.map(function(au,index){
                            //    aulist.push(au.Key);
                            //});
                            //app.article.allAUName.push({id:item.Id,aulist:aulist});
                            if (item.AU2.length > 0) {
                                html_list += '/';
                            }
                            for (var i = 0; i < item.AU2.length; i++) {
                                if (i > 2) {
                                    html_table += '<span style="cursor: pointer;padding-left:10px;" title="more authors" onclick="showAllAUName(' + item.Id + ')">......</span>';
                                    html_list += '<span style="cursor: pointer;padding-left:10px;" title="more authors" onclick="showAllAUName(' + item.Id + ')">......</span>';
                                    break;
                                }

                                html_table += '<a href="/Search/search?fd0=AU&kw0=' + item.AU2[i].Key + '">' + item.AU2[i].Value + '</a>';
                                html_list += '<a href="/Search/search?fd0=AU&kw0=' + item.AU2[i].Key + '">' + item.AU2[i].Value + '</a>';
                                if (item.AU2.length > i + 1 && i < 2) {
                                    html_table += ' , ';
                                    html_list += ' , ';
                                }
                            }
                        }
                        //标题列表-来源、下载、收藏
                        html_table += '</span></td><td> ' + item.SO + ' &nbsp;&nbsp;' + item.YR + ',  (' + item.NS + ') :' + item.PG.trimEnd('-').trimStart('-') + '</td>'+
                        '<td align="center" id="table_down_' + item.Id + '"><a class="txt_zhaiyao1" target="_blank"><a href="/article/info?aid=' + item.Id + ' " target="_blank">Fulltext</a></td>';
                        if (item.isCollection) {
                            html_table += '<td><a title="add"><img src="../res/images/Collect2.png" id="collectImage' + item.Id + '" onclick="collectArticle(' + item.Id + ')" value="2" style="cursor:pointer;" width="20" /></a>' +
                            //'<a title="核心期刊收录证明"><img src="../img/购物.png" onclick="addShoppingCart('+item.Id+')" style="cursor:pointer;margin-left:5px;" width="20" /></a>'+
                            '<a title="Cite"><img src="../img/引用.png" onclick="ShowReferenceFormat('+item.Id+')"  style="cursor:pointer;margin-left:5px;" width="20" /></a></td></tr>';

                        } else {
                            html_table += '<td><a title="add"><img src="../res/images/Collect1.png" id="collectImage' + item.Id + '" onclick="collectArticle(' + item.Id + ')" value="1" style="cursor:pointer;" width="20" /></a>'+
                            //'<a title="核心期刊收录证明"><img src="../img/购物.png" onclick="addShoppingCart('+item.Id+')"  style="cursor:pointer;margin-left:5px;" width="20" /></a>'+
                                '<a title="Cite"><img src="../img/引用.png" onclick="ShowReferenceFormat(' + item.Id + ')"  style="cursor:pointer;margin-left:5px;" width="20" /></a></td></tr>';
                        }


                        //详情列表-来源、摘要、关键词
                        html_list += '</span></dt><dd>Source： ' + item.SO + ' &nbsp;&nbsp;' + item.YR + ',  (' + item.NS + ') :' + item.PG.trimEnd('-').trimStart('-') + '</dd><dd><span class="xlt">Abstract：</span><span class="xrt">' + item.AB + '</span></dd>';
                        if (item.KW != undefined && item.KW != null && item.KW.length > 0 && item.KW[0] != '') {
                            html_list += '<dd>Keywords：';
                            item.KW.map(function(kw, index) {
                                html_list += kw;
                                if (item.KW.length > index + 1) {
                                    html_list += ' ; ';
                                }
                            });
                            html_list += '</dd>';
                        }
                        ////详情列表-中图分类号、下载、收藏
                        html_list += '<dd id="list_down_' + item.Id + '" ></dd>';
                        html_list += '<span>Download：</span><a class="txt_zhaiyao1" target="_blank"><a href="/article/info?id=' + item.Id + ' " target="_blank">Fulltext</a>';
                        if (item.isCollection) {
                            html_list += '<dd style="display:flex;" ><a style="display:flex;align-items: center;background-color: #ebebeb;border-radius: 5px;padding: 5px;padding-left: 10px;padding-right: 10px;cursor:pointer;margin-right:8px;" onclick="collectArticle(' + item.Id + ')"><img src="../res/images/Collect2.png" id="listcollectImage' + item.Id + '"  value="2" style="cursor:pointer;margin-bottom:0px;" width="20" /><span  style="height:20px">add</span></a>';
                        } else {
                            html_list += '<dd style="display:flex;" ><a style="display:flex;align-items: center;background-color: #ebebeb;border-radius: 5px;padding: 5px;padding-left: 10px;padding-right: 10px;cursor:pointer;margin-right:8px;" onclick="collectArticle(' + item.Id + ')"><img src="../res/images/Collect1.png" id="listcollectImage' + item.Id + '"  value="1" style="cursor:pointer;margin-bottom:0px;" width="20" /><span  style="height:20px">add</span></a>';
                        }
                          //html_list += '<a style="display:flex;align-items: center;background-color: #ebebeb;border-radius: 5px;padding: 5px;padding-left: 10px;padding-right: 10px;margin-left:10px;margin-right:10px;cursor:pointer" onclick="addShoppingCart(' + item.Id + ')"><img src="/img/购物.png"    style="cursor:pointer;margin-bottom:0px;" width="20" /><span  style="height:20px">核心期刊收录证明</span></a>';
                        html_list += '<a onclick="ShowReferenceFormat(' + item.Id + ')"  style="display:flex;align-items: center;background-color: #ebebeb;border-radius: 5px;padding: 5px;padding-left: 10px;padding-right: 10px;cursor:pointer;margin-bottom:0px;margin-right:8px;" ><img src="/img/引用.png"   style="margin-bottom:0px;" width="20" /><span style="height:20px">Cite</span></a></dd></dl>';
                        //app.article.getArticleDownloadInfo(item.AI, item.Id, item.YR);

                    });

                    $('#tu').html('<div id="article_list" class="article_list"><table class="table table-bordered table-hover"><thead><tr><th></th><th>Title</th><th style="min-width:100px;">Author</th><th>Source</th><th style="width: 12%;text-align:center;">Download</th><th style="width: 12%;text-align:center;">操作</th></tr></thead><tbody>' + html_table + '</tbody></table></div>');
                    $('#wenzi').html('<div class="wzxx">' + html_list + '</div>');
                } else {
                    var html = '<div style="padding: 50px;text-align: center;color: #d9534f;">There are currently no relevant records</div>';
                    $('#tu').html(html);
                    $('#wenzi').html(html);
                }
            },
            initPages: function(res) {
                //分页页码展示
                var pageHtml = '<div class="dropup"><a class="label label-danger" data-toggle="dropdown">' + res.PageSize + '/Page</a><div class="dropdown-menu" style="min-width: 80px;text-align: center;">';
                pageHtml += res.PageSize === 10 ? '<div><a class="dropdown-item label label-warning"> 10/Page</a></div>' : '<div><a class="dropdown-item label label-danger" onclick="javascript:app.article.selectPageSize(10);"> 10/Page</a></div>';
                pageHtml += res.PageSize === 20 ? '<div><a class="dropdown-item label label-warning"> 20/Page</a></div>' : '<div><a class="dropdown-item label label-danger" onclick="javascript:app.article.selectPageSize(20);"> 20/Page</a></div>';
                pageHtml += res.PageSize === 50 ? '<div><a class="dropdown-item label label-warning"> 50/Page</a></div>' : '<div><a class="dropdown-item label label-danger" onclick="javascript:app.article.selectPageSize(50);"> 50/Page</a></div>';
                pageHtml += res.PageSize === 100 ? '<div><a class="dropdown-item label label-warning"> 100/Page</a></div>' : '<div><a class="dropdown-item label label-danger" onclick="javascript:app.article.selectPageSize(100);"> 100/Page</a></div>';
                pageHtml += '</div></div>';

                var html = '<div class="pagination"><ul class="page_ul" style="overflow: initial;"><li style="margin-left: 0;"><span class="label label-danger">Total <span title="' + Number(res.Total).toLocaleString() + '">' +jn.numberToString( res.Total) + '</span> results</span></li><li>' + pageHtml + '</li></ul></div><div class="pagination" style="float: right;"><ul class="page_ul">';

                if (res.Pages > 1) {
                    html += '<li><a class="label label-danger" onclick="javascript:app.article.goToPages(1);">First page</a></li>';
                    html += '<li><a class="label label-danger" onclick="javascript:app.article.lastPages();">Prev page</a></li>';
                }
                var sPage = res.Pages - 3, ePage = res.Pages + 3;
                if (sPage < 1) { sPage = 1; }
                if (ePage > res.MaxPages) { ePage = res.MaxPages; }

                for (sPage; sPage <= ePage; sPage++) {
                    if (sPage == res.Pages) {
                        html += '<li><a class="label label-warning">' + sPage + '</a></li>';
                    } else {
                        html += '<li><a class="label label-danger" onclick="javascript:app.article.goToPages(' + sPage + ');">' + sPage + '</a></li>';
                    }
                }

                if (res.Pages < res.MaxPages) {
                    html += '<li><a class="label label-danger" onclick="javascript:app.article.nextPages();">Next page</a></li>';
                    html += '<li><a class="label label-danger" onclick="javascript:app.article.goToPages(' + res.MaxPages + ');">Last page</a></li>';
                }

                if (res.Total > 0) {
                    $('.page_list_box').html(html);
                }
            },
            getNewPageArticle: function(doType = 0) {

                $("#allcheckbox").prop("checked", false);
                $("#selectcount").text(0);

                abc.get({
                    url: "/Search/searchbysolr", data: {
                        key: app.article.keyword,
                        size: app.article.size,
                        page: app.article.page,
                        sort: app.article.sort,
                        sortFiled: app.article.sortFiled,
                        facetFields: app.article.facetFields
                    }, success: function(res) {
                        if (res.Status == 1) {

                            let warningText="";
                            //因为这个查询有可能是NaN
                            if(!isNaN(Number(app.article.searchData.Total))){
                                warningText+="[number] results has been found".replace("[number]",Number(app.article.searchData.Total).toLocaleString());
                            }
                            warningText+="only top [number] results can be viewed".replace("[number]",Number(res.SysMaxNumber).toLocaleString());
                            warningText+=",Change the order of search results to view more search results.";
                            $("#warning_text").html(warningText);

                            $("#warning_text").css("display", "");
                            $("#tu").css("display", "none");
                            $("#wenzi").css("display", "none");
                            return;
                        } else {
                            $("#warning_text").css("display", "none");
                            $("#tu").css("display", "");
                            $("#wenzi").css("display", "");

                            var aids = [];
                            res.List.map(function(item, index) {
                                aids.push(item.Id);
                            })
                            abc.post({
                                url: '/article/getListArticleCollectStatus', data: { aids: aids }
                                , success: function(data) {
                                    data.Data.map(function(t, i) {
                                        res.List.find((item, index) => {
                                            return item.Id == t.id;
                                        }).isCollection = t.isCollection;
                                    })
                                    app.article.searchData = res;
                                    app.article.initArticle(res);
                                    app.article.initPages(res);
                                    if (doType === 1) {
                                        app.article.initFields(res);
                                    }
                                }
                            });
                        }
                    }
                });


                ////doType = 0 不刷新左侧限定和排除条件，1刷新
                //$.ajax({
                //    type: "POST",
                //    url: "/Search/searchbysolr",
                //    data: {
                //        key: app.article.keyword,
                //        size: app.article.size,
                //        page:app.article.page,
                //        sort:app.article.sort,
                //        facetFields:app.article.facetFields
                //    },
                //    dataType: "json",
                //    success: function(res) {
                //        app.article.searchData = res;
                //        app.article.initArticle(res);
                //        app.article.initPages(res);
                //        if (doType === 1) {
                //            app.article.initFields(res);
                //        }
                //    }
                //});
            },
            goToPages: function(page) {
                app.article.page = page;
                app.article.getNewPageArticle();
            },
            lastPages: function() {
                if (app.article.page > 1) {
                    app.article.page = app.article.page - 1;
                    app.article.getNewPageArticle();
                }
            },
            nextPages: function() {
                console.log(app);
                if (app.article.page < app.article.searchData.MaxPages) {
                    app.article.page = app.article.page + 1;
                    app.article.getNewPageArticle();
                }
            },
            selectPageSize: function(value) {
                app.article.size = value;
                app.article.page = 1;
                app.article.getNewPageArticle();
            },
            //filed排序字段 0相关度 1发表时间 2标题 sort排序规则 1正序 2倒序
            sortArticle: function(filed = 0, sort = 1) { 
                  var  html = ''; 
                //相关度排序
                if (filed == 0) {
                    //根据相关性评分排序
                    app.article.sortFiled = 'score'; 
                    app.article.sort = 'dd';
                    html  = 'Sort by：<span class="red" style="margin:0px 5px 0px 0px;">Relevance<i class="fa fa-long-arrow-down" aria-hidden="true"></i></span>';
                
                    html+='<span  style="cursor:pointer;margin:0px 5px 0px 0px;" onclick="javascript:app.article.sortArticle(1,2);">Publish Time </span>';
                    html += '<span  style="cursor:pointer" onclick="javascript:app.article.sortArticle(2,2);">Title</span>';
                }
                if (filed == 1) {
                    //根据出版年，卷期，最后更新时间排序
                    app.article.sortFiled = "PD";
                    html = 'Sort by：<span style="cursor:pointer;margin:0px 5px 0px 0px;" onclick="javascript:app.article.sortArticle(0,1);">Relevance</span>';
                    if (sort == 1) {
                        app.article.sort = 'dd';
                        html += '<span class="red" style="cursor:pointer;margin:0px 5px 0px 0px;" onclick="javascript:app.article.sortArticle(1,2);">Publish Time <i class="fa fa-long-arrow-down" aria-hidden="true"></i></span>';
                    }
                    if (sort == 2) {

                        app.article.sort = 'da';
                        html += '<span class="red" style="cursor:pointer;margin:0px 5px 0px 0px;" onclick="javascript:app.article.sortArticle(1,1);">Publish Time <i class="fa fa-long-arrow-up" aria-hidden="true"></i></span>';
                    }
                    html += '<span  style="cursor:pointer" onclick="javascript:app.article.sortArticle(2,2);">Title</span>';
                }
                if (filed == 2) {
                    //根据标题排序
                    app.article.sortFiled = "TI";
                    html = 'Sort by：<span style="cursor:pointer;margin:0px 5px 0px 0px;" onclick="javascript:app.article.sortArticle(0,1);">Relevance</span>\
                                <span style="cursor:pointer;margin:0px 5px 0px 0px;" onclick="javascript:app.article.sortArticle(1,2);">Publish Time </span>\
                                ';
                    if (sort == 1) {
                        app.article.sort = 'dd';
                        html += '<span class="red" style="cursor:pointer" onclick="javascript:app.article.sortArticle(2,2);">Title <i class="fa fa-long-arrow-down" aria-hidden="true"></i></span>';
                    }
                    if (sort == 2) {
                        app.article.sort = 'da';
                        html += '<span class="red" style="cursor:pointer" onclick="javascript:app.article.sortArticle(2,1);">Title <i class="fa fa-long-arrow-up" aria-hidden="true"></i></span>';
                    }
                }
                $('.qk_shxu').html(html);
                app.article.page = 1;
                app.article.getNewPageArticle(1);
            },
            yearFormat: function(value) {
                return 2050 - parseInt(value);
            },
            authorFormat: function(value) {
                if (value == null || value == '') {
                    return "Anonymous";
                }
                return value;
            },
            filter: function(o, name, desc, com) {
                //左侧限定和排除条件筛选
                var is = $(com).parents('ul.menu').find('input:checkbox[name=fc_' + name + ']:checked');
                if (is.length > 0) {
                    //限制条件 new{ name="YR", desc="出版年度", type="AND",con="2020",Advanced = false }
                    var type = o === 0 ? "AND" : "NOT";
                    var con = [];
                    is.each(function() {
                        con.push($(this).val());
                    });
                    app.article.facetFields.push({ Name: name, Desc: desc, Type: type, Con: con, Advanced: false });
                    app.article.updateFilter();
                    app.article.page = 1;
                    app.article.getNewPageArticle(1);

                } else {
                    var msg = o === 0 ? "Limit" : "Exclude";

                    layer.msg('Please select "' + desc + '" and then click "' + msg + '"');
                }
            },
            updateFilter: function() {
                //刷新顶部筛选条件集合
                var html = '';
                var isordinary = false;
                if (app.article.searchModel === 'ordinary') {
                    isordinary = true;
                    html += 'Search Conditions：<b>Topic</b>("' + app.article.keyword + '")';
                } else {
                    html += 'Advanced：';
                }
                if (app.article.facetFields.length > 0) {
                    //html+=' AND ';
                    app.article.facetFields.map(function(item, index) {
                        if (index === 0) {
                            if (isordinary) {
                                html += ' <b>' + item.Type + ' ' + item.Desc + '</b>(';
                            } else {
                                if(item.Type!="NOT"  )
                                {
                                   html += ' <b>' + item.Desc + '</b>(';
                                }
                                else
                                {
                                    html += ' <b>' + item.Type + ' ' + item.Desc + '</b>(';
                                }
                            }

                        } else {
                            html += ' <b>' + item.Type + ' ' + item.Desc + '</b>(';
                        }
                        if (item.Desc == "Journals") {
                            html += '"' + item.JournalName + '"';
                        } else {
                            item.Con.map(function(itemCon, indexCon) {
                                if (indexCon === 0) {
                                    html += '"' + itemCon + '"';
                                } else {
                                    //if(item.Type=="NOT")
                                    //{
                                    //    html += ' AND "'+ itemCon +'"';
                                    //}
                                    //else
                                    //{
                                    //    html += ' OR "'+ itemCon +'"';
                                    //}
                                    html += ' , "' + itemCon + '"';
                                }
                            });
                        }

                        html += ')<img src="/res/images/rmv.gif" style="cursor:pointer;vertical-align:middle" onclick="javascript:app.article.removeFilter(' + index + ')">';
                    });
                } else {
                    if (app.article.searchModel === 'senior') {
                        app.article.searchModel = 'ordinary';
                        app.article.keyword = "*";
                        html = 'Search Conditions：<b>Topic</b>("' + app.article.keyword + '")';
                    }
                }
                $('#filterBox').html(html);
            },
            removeFilter: function(index) {
                //移除顶部筛选条件集合指定条件
                if (app.article.facetFields.length > index) {
                    app.article.facetFields.splice(index, 1);
                    app.article.updateFilter();
                    app.article.page = 1;
                    app.article.getNewPageArticle(1);
                }
            },
            getArticleDownloadInfo: function(aid, id, yr) {
                //获取文章下载相关描述
                $.ajax({
                    type: "get",
                    url: "/article/getArticleDownloadInfo?aid=" + aid + "&id=" + id + "&year=" + yr,
                    dataType: "json",
                    success: function(res) {
                        var html_table = '';
                        var html_list = '<span>Download：</span>';
                        if (res == null || res == undefined || res.length <= 0 || !res.some(function(i) { return i.oa; }) ) {
                            html_table += "<span>None</span>";
                            html_list += "<span>None</span>";
                        } else {
                            res.map(function(item, index) {
                                if (item.oa) {
                                    html_table += '<a href="' + item.url + '" title="' + item.dbname + '" target="_blank"><img  src="/res/favicons/' + item.dbid + '.ico" onerror="this.src=' + "'/res/favicons/cnp.ico'" + '" style="height:16px;width:16px;margin-right:5px;"></a>';
                                    html_list += '<a style="margin-right:10px;" href="' + item.url + '" target="_blank"><img  src="/res/favicons/' + item.dbid + '.ico" onerror="this.src=' + "'/res/favicons/cnp.ico'" + '" style="height:16px;width:16px;margin-right:5px;"><span>' + item.dbname + '</span></a>';
                                }
                             });
                        }

                        $('#table_down_' + id).html(html_table);
                        $('#list_down_' + id).append(html_list);
                    }
                });
            }
        }
    }
    $(function() {
        app.init();
    })

        function addArticleDownLoadNumber(id) {
            abc.post({
                url: "/article/AddArticleDownLoadNumber", data: { id: id }
                , success: function(result) { }
                , fail: function(result) { }
            });

        }

    function ListCollectlistArticle() {
        if (($("input[name='checkbox']:checked").length / 2) < 1) {
            layer.alert("Please select at least one result", {
                icon: 5,
                shadeClose: false,
                title: 'Error message', btn: ["Confirm"]
            });
        } else {
            var ids = [];
            $("input[name='checkbox']:checked").each(function(item, index) {
                ids.push($(this).attr("tag"));
            });

            abc.post({
                url: '/Article/ListCollectArticle', data: { ids: ids, type: 0 }
                , success: function(res) {
                    ids.map(function(item, index) {
                        $("#collectImage" + item).attr("src", "/res/images/Collect2.png");
                        $("#collectImage" + item).attr("value", "2");
                        $("#listcollectImage" + item).attr("src", "/res/images/Collect2.png");
                        $("#listcollectImage" + item).attr("value", "2");
                    })

                }, fail: function(res) {
                    if (res.loginRemind) {
                        layer.confirm('You are not logged in. Would you like to go to the login page?', {
                            icon: 3, title: 'Login prompt',
                            btn: ['Confirm', 'Cancel']
                        }
                            , function(index) {
                                window.location.href = "/account/login";
                                layer.close(index);
                            });
                    }
                }
            });
        }
    }

    function ListCancelCollectlistArticle() {
        if (($("input[name='checkbox']:checked").length / 2) < 1) {
            layer.alert("Please select at least one result", {
                icon: 5,
                shadeClose: false,
                title: 'Error message', btn: ["Confirm"]
            });
        } else {
            var ids = [];
            $("input[name='checkbox']:checked").each(function(item, index) {
                ids.push($(this).attr("tag"));
            });

            abc.post({
                url: '/Article/ListCollectArticle', data: { ids: ids, type: 1 }
                , success: function(res) {
                    ids.map(function(item, index) {
                        $("#collectImage" + item).attr("src", "/res/images/Collect1.png");
                        $("#collectImage" + item).attr("value", "1");
                        $("#listcollectImage" + item).attr("src", "/res/images/Collect1.png");
                        $("#listcollectImage" + item).attr("value", "1");
                    })
                }, fail: function(res) {
                    if (res.loginRemind) {
                        layer.confirm('You are not logged in. Would you like to go to the login page?', { icon: 3, title: 'Login prompt' , 
                                btn: ['Confirm', 'Cancel']}
                            , function(index) {
                                window.location.href = "/account/login";
                                layer.close(index);
                            });
                    }
                }
            });
        }
    }

    //收藏期刊
    function collectArticle(id) {
        abc.post({
            url: '/Article/CollectArticle', data: { ArticleId: id }
            , success: function(res) {
                if ($("#collectImage" + id).attr("value") == "1") {
                    $("#collectImage" + id).attr("src", "/res/images/Collect2.png");
                    $("#collectImage" + id).attr("value", "2");
                    $("#listcollectImage" + id).attr("src", "/res/images/Collect2.png");
                    $("#listcollectImage" + id).attr("value", "2");
                    abc.success("success!");
                } else {

                    $("#collectImage" + id).attr("src", "/res/images/Collect1.png");
                    $("#collectImage" + id).attr("value", "1");
                    $("#listcollectImage" + id).attr("src", "/res/images/Collect1.png");
                    $("#listcollectImage" + id).attr("value", "1");
                    abc.success("Cancelled successfully");
                }

            }, fail: function(res) {
                if (res.loginRemind) {
                    layer.confirm('You are not logged in. Would you like to go to the login page?', { icon: 3, title: 'Login prompt' , 
                                btn: ['Confirm', 'Cancel']}
                        , function(index) {
                            window.location.href = "/account/login";
                            layer.close(index);
                        });
                }
            }
        });
    }
    var listcheckbox = [];
    function allselect() {
        if ($("#allcheckbox").is(":checked")) {

            $("input[name='checkbox']").prop("checked", true);
            $("#selectcount").text($("input[name='checkbox']:checked").length / 2);

        } else {
            $("input[name='checkbox']").prop("checked", false);
            $("#selectcount").text(0);
        }
    }

    function selectChecked(id) {
        if ($("#cb_" + id).is(":checked")) {
            $("#cb_" + id).prop("checked", true);
            $("#listcb_" + id).prop("checked", true);
            $("#selectcount").text($("input[name='checkbox']:checked").length / 2);
        } else {
            $("#cb_" + id).prop("checked", false);
            $("#listcb_" + id).prop("checked", false);
            $("#selectcount").text($("input[name='checkbox']:checked").length / 2);
        }
    }

    function listSelectChecked(id) {
        if ($("#listcb_" + id).is(":checked")) {
            $("#cb_" + id).prop("checked", true);
            $("#listcb_" + id).prop("checked", true);
            $("#selectcount").text($("input[name='checkbox']:checked").length / 2);
        } else {
            $("#cb_" + id).prop("checked", false);
            $("#listcb_" + id).prop("checked", false);
            $("#selectcount").text($("input[name='checkbox']:checked").length / 2);
        }
    }

    //显示所以作者信息
    function showAllAUName(id) {
        var allAUNameStr = '  <div style="margin:20px;"><div style="  border-bottom: solid; margin-bottom: 10px;">Author</div><div>';
        //var aulist=   app.article.allAUName.find(function(item){return item.id==id;}).aulist;
        //aulist.map(function(item,index){
        //    allAUNameStr += '<a href="/Search/search?fd0=AU&kw0='+item+'">'+item+'</a>';
        //    if (aulist.length > index+1) {
        //        allAUNameStr += ' , ';
        //    }
        //});

        app.article.searchData.List.map(function(item, i) {
            if (item.Id == id) {
                item.AU2.map(function(au, j) {
                    allAUNameStr += '<a href="/Search/search?fd0=AU&kw0=' + au.Key + '">' + au.Value + '</a> ,';

                });
                if (item.AU2.length > 0) {
                    allAUNameStr = allAUNameStr.substring(0, allAUNameStr.length - 1);
                }
            }
        });


        allAUNameStr += '</div></div>';
        layer.open({
            type: 1,
            title: '',
            shadeClose: true,
            shade: 0.8,
            area: ['600px', '400px'],
            content: allAUNameStr
        });
    }

   
      function addShoppingCart(id) {
            abc.post({
                url: '/user/AddShoppingCart', data: { ArticleId: id }
                , success: function(res) {
                    abc.success("Added Successfully");
                    abc.post({ url: '/user/GetIncludeArticleCount' ,success: function(r) {
                        $("#IncludedArticleCount").text("(" + r.Data + ")篇");
                    }});

                }, fail: function(res) {
                    if (res.loginRemind) {
                    layer.confirm('You are not logged in. Would you like to go to the login page?', {
                        icon: 3, title: 'Login prompt',
                        btn: ['Confirm', 'Cancel']
                    }
                            , function(index) {
                                window.location.href = "/account/login";
                                layer.close(index);
                            });
                    }
                }
            });
        }

function ShowReferenceFormat(id) 
{
    abc.open({title:"Cite this article",url:"/article/ReferenceFormat?id="+id,area:["900px","500px"]});
}
</script>

<script>

    String.prototype.trimEnd = function(c) {
        if (c == null || c == "") {
            var str = this;
            var rg = /s/;
            var i = str.length;
            while (rg.test(str.charAt(--i)));
            return str.slice(0, i + 1);
        }
        else {
            var str = this;
            var rg = new RegExp(c);
            var i = str.length;
            while (rg.test(str.charAt(--i)));
            return str.slice(0, i + 1);
        }
    }


    //去除字符串头部空格或指定字符
    String.prototype.trimStart = function(c) {
        if (c == null || c == "") {
            var str = this.replace(/^s*/, '');
            return str;
        }
        else {
            var rg = new RegExp("^" + c + "*");
            var str = this.replace(rg, '');
            return str;
        }
    }
</script>




    <!--页脚-->
    
<style>

    .link_tab ul li {
        display: flex;
        justify-content: center;
        align-items: center;
        text-align: center; 
        height:95px;
    }
</style>

<div style="position:relative;min-width: 1280px;">

    <div class="redbg">
        <div class="container">
            <div class="row">
                <div class="link_tab">
                    <ul>
                        <li class="col-md-3">
                            <a href="https://www.lib.pku.edu.cn/portal/" target="_blank"><img src="/res/images/list/links2.png" class="img-responsive"></a>
                        </li>
                        <li class="col-md-3">
                            <a href="http://hxqk.lib.pku.edu.cn/" target="_blank"><img src="/res/images/list/hxqklogo.png" class="img-responsive"></a>
                        </li>
                        <li class="col-md-3">
                            <a href="http://nssd.cn/" target="_blank"><img src="/res/images/list/nssd.jpg" class="img-responsive"></a>
                        </li>
                        <li class="col-md-3">
                            <a href="https://doaj.istic.ac.cn/" target="_blank"><img src="/res/images/list/gjkjqk.png" class="img-responsive"></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="footer">
        <div class="container">
            <div class="col-lg-8">
                <div class="banquan">
                    <a style="color:white" href="https://www.miit.gov.cn/" target="_blank">   </a>
                    <br>
                    Address： No.5 Yiheyuan Road, Haidian District, Beijing　Post Code：100871
                    <br>
                    ©2012-2023 北京大学 版权所有<br>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="fengxiang">
                    <ul>
                        <li style="float:right;" onclick="weiboshare()">
                            <i class="fa fa-weibo" aria-hidden="true"></i>
                        </li>
                        <li onclick="wxQrCodeShow()" id="wxpcode" style="float:right;">
                            <i class="fa fa-weixin" onclick="wxQrCodeHide()">
                            </i>
                        </li>
                    </ul>


                </div>
            </div>
        </div>
    </div>

    <div id="pcode" style="margin:auto;left: 0px;right: 0px;top: 0px;bottom: 0px;position:fixed;z-index:9999; display:none;background-color:white;width:300px; height:280px;border:solid 4px rgb(212 120 120)">
        <div style="margin:10px;">
            <div style=" margin-left: 30px;
    margin-top: 21px;">

                <span style="font-weight:bold;font-size: 16px;">
                    Scan QR code on WeChat to share with friends
                </span>
            </div>
            <div id="qrcode" style="margin-left: 40px;width: 170px;height: 170px;margin-top: 20px;">
            <canvas width="170" height="170"></canvas></div>
        </div>

    </div>
</div>
<script type="text/javascript" src="/lib/layuiformrender/libs/jquery/jquery-3.6.0.min.js"></script>
<script type="text/javascript" src="/lib/QrCode/jeromeetienne-jquery/jquery.qrcode.min.js"></script>
<script>

    $(function () {

        $("#qrcode").qrcode(
            {
                width: 170,
                height: 170,
                text: window.location.href
            }
        );

        $('#wxpcode').click(function (event) {
            //取消事件冒泡
            event.stopPropagation();
            //按钮的toggle,如果div是可见的,点击按钮切换为隐藏的;如果是隐藏的,切换为可见的。
            $("#pcode").show();
            return false;
        });

        //点击空白处隐藏弹出层，下面为滑动消失效果和淡出消失效果。
        $(document).click(function (event) {
            var _con = $('#pcode');  // 设置目标区域
            if (!_con.is(event.target) && _con.has(event.target).length === 0) { // Mark 1
                //$('#divTop').slideUp('slow');  //滑动消失
                $('#pcode').hide();     //淡出消失
            }
        });
    })

    function wxQrCodeShow() {
        $("#pcode").show();
    }
    function wxQrCodeHide() {
        $("#pcode").hide();
    }

    function weiboshare() {
        var sharetitle = '';
        if (window.location.pathname == "/journal/info") {
            sharetitle = '';
        }

        if (window.location.pathname == "/article/info") {
            sharetitle = '';
        }

        if (window.location.href.indexOf("&") != -1) {
            var href = window.location.protocol + "//" + window.location.host + window.location.pathname;
            window.open('http://service.weibo.com/share/share.php?url=' + href + '&appkey=&language=zh_cn&title=' + sharetitle + '&source=&sourceUrl=&ralateUid=&message=&uids=&pic=&searchPic=true&content=');

        } else {
            window.open('http://service.weibo.com/share/share.php?url=' + window.location.href + '&appkey=&language=zh_cn&title=' + sharetitle + '&source=&sourceUrl=&ralateUid=&message=&uids=&pic=&searchPic=true&content=');
        }
    }
</script>
    <!--高级搜索-->
    <div class="search_more_box" id="search_more_box">
    <div class="search_box">
        <div class="row">
            <div class="ej">
                <div class="item_title">
                    <h4>Advanced</h4>
                    <span style="float:right;margin-right:20px;cursor:pointer;" onclick="hideAdvancedSearch()"><i class="fa fa-close"></i></span>
                </div>
                <div class="content_nr">
                    <form name="search_form" id="search_form" onsubmit="return checkForm()">
                        <table width="100%" cellspacing="0" cellpadding="0" border="0" align="center" class="table_A">
                            <thead>
                                <tr>
                                    <th class="t_w1">Associator</th>
                                    <th class="t_w2">Search Fields</th>
                                    <th class="t_w3">Keywords</th>
                                    <th class="t_w4"></th>
                                </tr>
                            </thead>

                            <tbody id="search_body">
                                <tr>
                                    <td></td>
                                    <td>
                                        <select id="fd0" name="fd0" onchange="SelectSubject('0','kw0_td')">
                                    <option value="TI" selected="">Title</option>
                                    <option value="AU">Author</option>
                                    <option value="AF">Affiliation(s)</option>
                                    <option value="AB">Abstract</option>
                                    <option value="KW">Keywords</option>
                                    <option value="SB">Discipline</option>
                                    <option value="SO">Journal Title</option>
                                    <option value="PB">publisher</option>
                                    <option value="SN">ISSN/ISBN</option>
                                    <option value="LG">Language</option>
                                    <option value="DO">DOI</option>
                                    <option value="ZT">Topic</option>
                                    <option value="TX">All fields</option>
                                        </select>
                                    </td>
                                    <td id="kw0_td">
                                        <div style="display:flex;" class="text">
                                            <input class="text" autocomplete="off" name="kw0" id="kw0" value="">
                                            <select style="width:120px;" name="qt0" id="qt0">
                                                <option selected="selected" value="0">Fuzzy</option>
                                                <option value="1">Accurate</option>
                                            </select>
                                        </div>
                                    </td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>
                                        <select id="op1" name="op1">
                                            <option value="AND">AND</option>
                                            <option value="OR">OR</option>
                                            <option value="NOT">NOT</option>
                                        </select>
                                    </td>
                                    <td>
                                        <select id="fd1" name="fd1" onchange="SelectSubject('1','kw1_td')">
                                    <option value="TI">Title</option>
                                    <option value="AU" selected="">Author</option>
                                    <option value="AF">Affiliation(s)</option>
                                    <option value="AB">Abstract</option>
                                    <option value="KW">Keywords</option>
                                    <option value="SB">Discipline</option>
                                    <option value="SO">Journal Title</option>
                                    <option value="PB">publisher</option>
                                    <option value="SN">ISSN/ISBN</option>
                                    <option value="LG">Language</option>
                                    <option value="DO">DOI</option>
                                    <option value="ZT">Topic</option>
                                    <option value="TX">All fields</option>
                                        </select>
                                    </td>
                                    <td id="kw1_td">
                                        <div style="display:flex;" class="text">
                                            <input class="text" autocomplete="off" name="kw1" id="kw1" value="">
                                            <select style="width:120px;" name="qt1" id="qt1">
                                                <option selected="selected" value="0">Fuzzy</option>
                                                <option value="1">Accurate</option>
                                            </select>
                                        </div>
                                    </td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>
                                        <select id="op2" name="op2">
                                            <option value="AND">AND</option>
                                            <option value="OR">OR</option>
                                            <option value="NOT">NOT</option>
                                        </select>
                                    </td>
                                    <td>
                                        <select id="fd2" name="fd2" onchange="SelectSubject('2','kw2_td')">
                                    <option value="TI">Title</option>
                                    <option value="AU">Author</option>
                                    <option value="AF">Affiliation(s)</option>
                                    <option value="AB" selected="">Abstract</option>
                                    <option value="KW">Keywords</option>
                                    <option value="SB">Discipline</option>
                                    <option value="SO">Journal Title</option>
                                    <option value="PB">publisher</option>
                                    <option value="SN">ISSN/ISBN</option>
                                    <option value="LG">Language</option>
                                    <option value="DO">DOI</option>
                                    <option value="ZT">Topic</option>
                                    <option value="TX">All fields</option>
                                        </select>
                                    </td>
                                    <td id="kw2_td">
                                        <div style="display:flex;" class="text">
                                            <input class="text" autocomplete="off" name="kw2" id="kw2" value="">
                                            <select style="width:120px;" name="qt2" id="qt2">
                                                <option selected="selected" value="0">Fuzzy</option>
                                                <option value="1">Accurate</option>
                                            </select>
                                        </div>
                                    </td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>
                                        <select id="op3" name="op3">
                                            <option value="AND">AND</option>
                                            <option value="OR">OR</option>
                                            <option value="NOT">NOT</option>
                                        </select>
                                    </td>
                                    <td>
                                        <select id="fd3" name="fd3" onchange="SelectSubject('3','kw3_td')">
                                    <option value="TI">Title</option>
                                    <option value="AU">Author</option>
                                    <option value="AF">Affiliation(s)</option>
                                    <option value="AB">Abstract</option>
                                    <option value="KW" selected="">Keywords</option>
                                    <option value="SB">Discipline</option>
                                    <option value="SO">Journal Title</option>
                                    <option value="PB">publisher</option>
                                    <option value="SN">ISSN/ISBN</option>
                                    <option value="LG">Language</option>
                                    <option value="DO">DOI</option>
                                    <option value="ZT">Topic</option>
                                    <option value="TX">All fields</option>
                                        </select>
                                    </td>
                                    <td id="kw3_td">
                                        <div style="display:flex;" class="text">
                                            <input class="text" autocomplete="off" name="kw3" id="kw3" value="">
                                            <select style="width:120px;" name="qt3" id="qt3">
                                                <option selected="selected" value="0">Fuzzy</option>
                                                <option value="1">Accurate</option>
                                            </select>
                                        </div>
                                    </td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>
                                        <select id="op4" name="op4">
                                            <option value="AND">AND</option>
                                            <option value="OR">OR</option>
                                            <option value="NOT">NOT</option>
                                        </select>
                                    </td>
                                    <td>
                                        <select id="fd4" name="fd4" onchange="SelectSubject('4','kw4_td')">
                                    <option value="TI">Title</option>
                                    <option value="AU">Author</option>
                                    <option value="AF">Affiliation(s)</option>
                                    <option value="AB">Abstract</option>
                                    <option value="KW">Keywords</option>
                                    <option value="SB">Discipline</option>
                                    <option value="SO">Journal Title</option>
                                    <option value="PB" selected="">publisher</option>
                                    <option value="SN">ISSN/ISBN</option>
                                    <option value="LG">Language</option>
                                    <option value="DO">DOI</option>
                                    <option value="ZT">Topic</option>
                                    <option value="TX">All fields</option>
                                        </select>
                                    </td>
                                    <td>
                                        <div id="kw4_td" class="text" style="float:left;display:flex;">
                                            <input class="text" autocomplete="off" name="kw4" id="kw4" value="">
                                            <select style="width:120px;" name="qt4" id="qt4">
                                                <option selected="selected" value="0">Fuzzy</option>
                                                <option value="1">Accurate</option>
                                            </select>
                                        </div>
                                        <div style="height: 34px;display: flex;justify-items: center;align-items: center;">
                                            <a style="margin-left:4px;" class="xT_aBtn btn_add_a J-do-key" onclick="javascript:AddEle();"><img src="/res/images/advance_add.gif"></a>
                                        </div>
                                    </td>
                                    <td>
                                    </td>
                                </tr>
                                <tr id="tr5" style="display:none"></tr>
                                <tr id="tr6" style="display:none"></tr>
                                <tr id="tr7" style="display:none"></tr>
                                <tr id="tr8" style="display:none"></tr>
                                <tr id="tr9" style="display:none"></tr>
                                <tr><td colspan="4"></td></tr>
                            </tbody>

                            <tfoot>
                                <tr class="lineA"><td colspan="4"></td></tr>
                                <tr><td colspan="4"></td></tr>
                                <tr>
                                    <th>Year</th>
                                    <td colspan="2">
                                        <input type="text" name="syr" id="syr" value="" class="i-t-short" autocomplete="OFF"> - <input type="text" name="eyr" id="eyr" value="" autocomplete="OFF" class="i-t-short">

                                        <input type="button" class="btn btn-danger search-btn" onclick="initAdvancedSesrchFrom()" value="Reset" style="background-color: #f0ad4e;margin-left:30px;">
                                        <input type="submit" class="btn btn-danger search-btn" value="Search">
                                    </td>
                                </tr>
                            </tfoot>
                        </table>
                    </form>
                </div>
            </div>

        </div>
    </div>
</div>
<style>
    .search-key {
        width: 380px;
        border: #e3e3e3 1px solid;
        border-right: none;
        border-radius: 3px 0 0 3px;
        position: relative;
        outline: none;
        border-top-right-radius: 0;
        border-bottom-right-radius: 0;
    }

    .search-key-s {
        width: 290px;
    }

    .ovfHiden {
        overflow: hidden;
        height: 100%;
    }

    .search_box .ej .content_nr {
        padding: 20px 40px;
    }

    #search_body tr {
        height: 44px !important;
        line-height: 44px;
    }

        #search_body tr td .text {
            width: 570px !important;
        }

    #search_body select {
        height: 34px;
        line-height: 34px;
        border-radius: 6px;
        border: 1px solid #c0c0c0;
        margin-right: 10px;
    }

    #search_body input {
        height: 34px;
        line-height: 34px;
        border-radius: 6px;
        border: 1px solid #c0c0c0;
        padding: 0 10px;
    }

    .J-do-key img {
        margin-bottom: 0;
    }

    .table_A tfoot input {
        height: 34px;
        line-height: 34px;
        border-radius: 6px;
        border: 1px solid #c0c0c0;
        padding: 0 10px;
    }

    .table_A tfoot .search-btn {
        float: right;
        min-width: 160px;
    }

    .datetimepicker table tr td span {
        height: 40px !important;
        line-height: 40px !important;
        font-size: 12px;
    }

        .datetimepicker table tr td span.active {
            background-color: #C9302C !important;
            background-image: linear-gradient(to bottom,#e93a36,#C9302C) !important;
        }

    .datetimepicker table tr td.day {
        height: 20px !important;
        width: 30px !important;
        line-height: 20px !important;
        font-size: 12px;
    }

    .datetimepicker table tr td.active {
        background-color: #C9302C !important;
        background-image: linear-gradient(to bottom,#e93a36,#C9302C) !important;
    }
</style>


<link href="/res/js/bootstrap-datetimepicker/bootstrap-datetimepicker.min.css" rel="stylesheet">
<script src="/res/js/bootstrap-datetimepicker/bootstrap-datetimepicker.min.js"></script>
<script type="text/javascript">
    $(function () {
        $(".i-t-short").datetimepicker({
            format: 'yyyy', // 展现格式
            startDate: "1900",// 开始时间
            endDate: "2050", // 结束时间
            autoclose: true, // 选择日期后关闭
            // 0表示分钟(默认),1表示小时,2表示天,3表示月,4表示年
            startView: 4,
            // 选择器所能够提供的最精确的时间选择视图
            // 0表示分钟(默认),1表示小时,2表示天,3表示月,4表示年
            minView: 4,
            language: 'zh-CN' //显示语言为中文
        });

        searchHtmlStr = $("#search_form").html();
    });

    var searchPar = {
        fields: [
            {
                Id: 0,
                Name: "kw0",
            },
            {
                Id: 1,
                Name: "kw1",
            },
            {
                Id: 2,
                Name: "kw2",
                Type: "text",
            },
            {
                Id: 3,
                Name: "kw3",
            },
            {
                Id: 4,
                Name: "kw4",
            },
        ],
    };
    function AddEle() {
        var x = 0;
        for (var id = 5; id < 10; id++) {
            var obj = document.getElementById("tr" + id);
            var htm;
            htm = obj.innerHTML + "";
            if (htm.length < 10) {
                htm = "<td><select id=\"op" + id + "\" name=\"op" + id + "\"><option value=\"AND\">AND<\/option><option value=\"OR\">OR<\/option><option value=\"NOT\">NOT<\/option><\/select><\/td>";
                htm += "<td><select id=\"fd" + id + "\" name=\"fd" + id + "\" onchange=\"SelectSubject('" + id + "','kw" + id + "_td')\"><option value=\"AI\">Article ID</option><option value=\"TI\">Title</option><option value=\"AU\">Author</option><option value=\"AF\">Affiliation(s)</option><option value=\"AB\">Abstract</option><option value=\"KW\">Keywords</option><option value=\"SB\">Discipline</option><option value=\"SO\">Source</option><option value=\"PB\">publisher</option><option value=\"SN\">ISSN/ISBN</option><option value=\"LG\">Language</option><option value=\"DO\">DOI</option><option value=\"ZT\">Topic</option><option value=\"TX\">All fields</option><\/select><\/td>";
                htm += "<td><div id=\"kw" + id + "_td\" style=\"float:left;display:flex;\" class=\"text\"> <input class=\"text\" autocomplete=\"off\" name=\"kw" + id + "\" id=\"kw" + id + "\" value=\"\"> " +
                    '<select style="width:120px;" name="qt' + id + '" id="qt' + id + '">\
                                                    <option selected="selected" value="0">Fuzzy</option>\
                                                        <option value="1">Accurate</option>\
                                                </select> </div> '+ "<div style='height: 34px;display: flex;justify-items: center;align-items: center;'> <a style=\"margin-left:4px;\" class=\"T_aBtn btn_remove_a J-do-key\" data-type=\"add\" href=\"###\" onclick=\"javascript:RmvEle(" + id + ");\"><img src='/res/images/advance_cut.gif'/></a></div></td><td><\/td>";
                obj.innerHTML = htm;
                $("#tr" + id).show();
                x++;
                searchPar.fields.push({ Id: id, Name: "kw" + id });
                break;
            }
        }
        if (x == 0) {
            layer.msg('There are already enough search domains');
        }
        return false;
    }

    function RmvEle(ix) {
        document.getElementById("tr" + ix).innerHTML = "";
        $("#tr" + ix).hide();
        searchPar.fields = searchPar.fields.filter(function (item) {
            return item.Id != ix;
        });
    }

    var searchHtmlStr;
    //初始化高级检索表单
    function initAdvancedSesrchFrom() {
        $("#search_form").empty();
        $("#search_form").append(searchHtmlStr);

        $(".i-t-short").datetimepicker({
            format: 'yyyy', // 展现格式
            startDate: "1900",// 开始时间
            endDate: "2050", // 结束时间
            autoclose: true, // 选择日期后关闭
            // 0表示分钟(默认),1表示小时,2表示天,3表示月,4表示年
            startView: 4,
            // 选择器所能够提供的最精确的时间选择视图
            // 0表示分钟(默认),1表示小时,2表示天,3表示月,4表示年
            minView: 4,
            language: 'zh-CN' //显示语言为中文
        });
    }

    function showAdvancedSearch() {
        //$('html,body').addClass('ovfHiden'); //使网页不可滚动
        $('#search_more_box').height(document.body.clientHeight);
        $("#search_more_box").show();
    }

    function hideAdvancedSearch() {
        //$('html,body').removeClass('ovfHiden'); //使网页恢复可滚
        $("#search_more_box").hide();
    }
    function checkForm() {
        var syr = $("#syr").val();
        var eyr = $("#eyr").val();
        if (syr != '' && eyr != '') {
            if (parseInt(syr) > parseInt(eyr)) {
                layer.msg('Wrong start and end period'); return false;
            }
        }

        hideAdvancedSearch();
        var searchParStr = "";
        searchPar.fields.map(function (item, index) {
            //添加查询字段
            var fdstr = $("#fd" + item.Id).val();
            searchParStr += "fd" + item.Id + "=" + fdstr + "&";

            //添加字段检索值
            var valueStr = $("#" + item.Name).val();
            searchParStr += item.Name + "=" + valueStr + "&";

            //添加字段是否精确匹配
            var isAccurate = $("#qt" + item.Id).val();
            searchParStr += "IsAccurate" + item.Id + "=" + isAccurate + "&";

            //添加检索逻辑
            if (index > 0) {
                var opstr = $("#op" + item.Id).val();
                searchParStr += "op" + item.Id + "=" + opstr + "&";
            }

        });

        //判断是否选择起止年度
        if (syr != '') {
            searchParStr += 'syr=' + syr + '&'
        }
        //判断是否选择起止年度
        if (eyr != '') {
            searchParStr += 'eyr=' + eyr + '&'
        }

        console.log(searchParStr, 'searchParStr')


        searchParStr = searchParStr.slice(0, searchParStr.length - 1);




        location.href = '/Search/search?' + searchParStr;
        return false;
    }


    //选择学科时，更换input为下拉框
    function SelectSubject(selectId, td) {
        if ($("#fd" + selectId).val() == "SB")//学科下拉框
        {
            $("#" + td).empty();
            abc.post({
                url: "/Journal/GetAllSubject", data: {}
                , success: function (result) {
                    var html = "";

                    html = ' <select class="text" style="margin-right:0px;" id="kw' + selectId + '" name="kw' + selectId + '">';
                    result.Data.map(function (item, i) {
                        html += '<option value="' + item.Name + '">' + item.Name + '</option>';
                    });
                    html += '</select>';
                    $("#" + td).append(html);
                }
            });
        } else if ($("#fd" + selectId).val() == "LG")//语种下拉框
        {
            $("#" + td).empty();
            abc.post({
                url: "/Journal/GetAllLanguage", data: {}
                , success: function (result) {
                    var html = "";

                    html = ' <select class="text" style="margin-right:0px;" id="kw' + selectId + '" name="kw' + selectId + '">';
                    result.Data.map(function (item, i) {
                        html += '<option value="' + item.Name + '">' + item.Name + '</option>';
                    });
                    html += '</select>';
                    $("#" + td).append(html);
                }
            });
        }
        else//普通文本
        {
            $("#" + td).empty();
            var html = '<div style=\"float:left;display:flex;\" class=\"text\"><input class="text" autocomplete="off" name="kw' + selectId + '" id="kw' + selectId + '" value=""> <select style="width:120px;" name="qt' + selectId + '" id="qt' + selectId + '">\
                                                        <option selected="selected" value="0">Fuzzy</option>\
                                                        <option value="1">Accurate</option>\
                                                </select></div>';
            $("#" + td).append(html);

        }
    }
</script>


    <div class="top_web" id="backtop" style="display: none; color: white; background-color: rgb(148, 7, 10);">
        <span class="glyphicon glyphicon-menu-up" aria-hidden="true"></span>
    </div>    <!--返回顶部-->
    <script type="text/javascript">
        $(document).ready(function () {
            $("#backtop").hide();
            $(window).scroll(function () {
                if ($(this).scrollTop() > 50) {
                    $('#backtop').fadeIn();
                } else {
                    $('#backtop').fadeOut();
                }
            });
            $('#backtop').click(function () {
                $('body,html').animate({
                    scrollTop: 0
                }, 500);
            });
            $("pre").addClass("prettyprint");
            //prettyPrint();
        });

        // 在页面加载时检查 URL 片段
        window.addEventListener('load', function() {
            const fragment = window.location.hash.substring(1); // 获取 # 后的内容
            if (fragment) {
                // 检查危险协议（示例）
                const dangerousProtocols = ['javascript:', 'vbscript:', 'data:'];
                const hasDanger = dangerousProtocols.some(proto => fragment.toLowerCase().includes(proto));

                if (hasDanger) {
                    // 重定向到清理后的 URL（移除危险内容）
                    const cleanUrl = window.location.href.split('#')[0];
                    window.location.replace(cleanUrl);
                }
            }
        });
    </script>
    <!--返回顶部end-->
    
    
    
<div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" role="dialog" tabindex="-1" style="display: none;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><button type="button" id="cboxPrevious"></button><button type="button" id="cboxNext"></button><button id="cboxSlideshow"></button><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none;"></div></div><div class="layui-layer-move" id="layui-layer-move"></div><div class="datetimepicker datetimepicker-dropdown-bottom-right dropdown-menu" style="left: 0px; z-index: 2147483647;"><div class="datetimepicker-minutes" style="display: none;"><table class=" table-condensed"><thead><tr><th class="prev" style="visibility: visible;"><span class="glyphicon glyphicon-arrow-left"></span> </th><th colspan="5" class="switch">28 二月 2025</th><th class="next" style="visibility: visible;"><span class="glyphicon glyphicon-arrow-right"></span> </th></tr></thead><tbody><tr><td colspan="7"><span class="minute">10:00</span><span class="minute">10:05</span><span class="minute">10:10</span><span class="minute">10:15</span><span class="minute active">10:20</span><span class="minute">10:25</span><span class="minute">10:30</span><span class="minute">10:35</span><span class="minute">10:40</span><span class="minute">10:45</span><span class="minute">10:50</span><span class="minute">10:55</span></td></tr></tbody><tfoot><tr><th colspan="7" class="today" style="display: none;">今天</th></tr><tr><th colspan="7" class="clear" style="display: none;">清除</th></tr></tfoot></table></div><div class="datetimepicker-hours" style="display: none;"><table class=" table-condensed"><thead><tr><th class="prev" style="visibility: visible;"><span class="glyphicon glyphicon-arrow-left"></span> </th><th colspan="5" class="switch">28 二月 2025</th><th class="next" style="visibility: visible;"><span class="glyphicon glyphicon-arrow-right"></span> </th></tr></thead><tbody><tr><td colspan="7"><span class="hour">0:00</span><span class="hour">1:00</span><span class="hour">2:00</span><span class="hour">3:00</span><span class="hour">4:00</span><span class="hour">5:00</span><span class="hour">6:00</span><span class="hour">7:00</span><span class="hour">8:00</span><span class="hour">9:00</span><span class="hour active">10:00</span><span class="hour">11:00</span><span class="hour">12:00</span><span class="hour">13:00</span><span class="hour">14:00</span><span class="hour">15:00</span><span class="hour">16:00</span><span class="hour">17:00</span><span class="hour">18:00</span><span class="hour">19:00</span><span class="hour">20:00</span><span class="hour">21:00</span><span class="hour">22:00</span><span class="hour">23:00</span></td></tr></tbody><tfoot><tr><th colspan="7" class="today" style="display: none;">今天</th></tr><tr><th colspan="7" class="clear" style="display: none;">清除</th></tr></tfoot></table></div><div class="datetimepicker-days" style="display: none;"><table class=" table-condensed"><thead><tr><th class="prev" style="visibility: visible;"><span class="glyphicon glyphicon-arrow-left"></span> </th><th colspan="5" class="switch">二月 2025</th><th class="next" style="visibility: visible;"><span class="glyphicon glyphicon-arrow-right"></span> </th></tr><tr><th class="dow">日</th><th class="dow">一</th><th class="dow">二</th><th class="dow">三</th><th class="dow">四</th><th class="dow">五</th><th class="dow">六</th></tr></thead><tbody><tr><td class="day old">26</td><td class="day old">27</td><td class="day old">28</td><td class="day old">29</td><td class="day old">30</td><td class="day old">31</td><td class="day">1</td></tr><tr><td class="day">2</td><td class="day">3</td><td class="day">4</td><td class="day">5</td><td class="day">6</td><td class="day">7</td><td class="day">8</td></tr><tr><td class="day">9</td><td class="day">10</td><td class="day">11</td><td class="day">12</td><td class="day">13</td><td class="day">14</td><td class="day">15</td></tr><tr><td class="day">16</td><td class="day">17</td><td class="day">18</td><td class="day">19</td><td class="day">20</td><td class="day">21</td><td class="day">22</td></tr><tr><td class="day">23</td><td class="day">24</td><td class="day">25</td><td class="day">26</td><td class="day">27</td><td class="day active">28</td><td class="day new">1</td></tr><tr><td class="day new">2</td><td class="day new">3</td><td class="day new">4</td><td class="day new">5</td><td class="day new">6</td><td class="day new">7</td><td class="day new">8</td></tr></tbody><tfoot><tr><th colspan="7" class="today" style="display: none;">今天</th></tr><tr><th colspan="7" class="clear" style="display: none;">清除</th></tr></tfoot></table></div><div class="datetimepicker-months" style="display: none;"><table class="table-condensed"><thead><tr><th class="prev" style="visibility: visible;"><span class="glyphicon glyphicon-arrow-left"></span> </th><th colspan="5" class="switch">2025</th><th class="next" style="visibility: visible;"><span class="glyphicon glyphicon-arrow-right"></span> </th></tr></thead><tbody><tr><td colspan="7"><span class="month">一月</span><span class="month active">二月</span><span class="month">三月</span><span class="month">四月</span><span class="month">五月</span><span class="month">六月</span><span class="month">七月</span><span class="month">八月</span><span class="month">九月</span><span class="month">十月</span><span class="month">十一月</span><span class="month">十二月</span></td></tr></tbody><tfoot><tr><th colspan="7" class="today" style="display: none;">今天</th></tr><tr><th colspan="7" class="clear" style="display: none;">清除</th></tr></tfoot></table></div><div class="datetimepicker-years" style="display: block;"><table class="table-condensed"><thead><tr><th class="prev" style="visibility: visible;"><span class="glyphicon glyphicon-arrow-left"></span> </th><th colspan="5" class="switch">2020-2029</th><th class="next" style="visibility: visible;"><span class="glyphicon glyphicon-arrow-right"></span> </th></tr></thead><tbody><tr><td colspan="7"><span class="year ">2019</span><span class="year">2020</span><span class="year">2021</span><span class="year">2022</span><span class="year">2023</span><span class="year">2024</span><span class="year active">2025</span><span class="year">2026</span><span class="year">2027</span><span class="year">2028</span><span class="year">2029</span><span class="year ">2030</span></td></tr></tbody><tfoot><tr><th colspan="7" class="today" style="display: none;">今天</th></tr><tr><th colspan="7" class="clear" style="display: none;">清除</th></tr></tfoot></table></div></div><div class="datetimepicker datetimepicker-dropdown-bottom-right dropdown-menu" style="left: 0px; z-index: 2147483647;"><div class="datetimepicker-minutes" style="display: none;"><table class=" table-condensed"><thead><tr><th class="prev" style="visibility: visible;"><span class="glyphicon glyphicon-arrow-left"></span> </th><th colspan="5" class="switch">28 二月 2025</th><th class="next" style="visibility: visible;"><span class="glyphicon glyphicon-arrow-right"></span> </th></tr></thead><tbody><tr><td colspan="7"><span class="minute">10:00</span><span class="minute">10:05</span><span class="minute">10:10</span><span class="minute">10:15</span><span class="minute active">10:20</span><span class="minute">10:25</span><span class="minute">10:30</span><span class="minute">10:35</span><span class="minute">10:40</span><span class="minute">10:45</span><span class="minute">10:50</span><span class="minute">10:55</span></td></tr></tbody><tfoot><tr><th colspan="7" class="today" style="display: none;">今天</th></tr><tr><th colspan="7" class="clear" style="display: none;">清除</th></tr></tfoot></table></div><div class="datetimepicker-hours" style="display: none;"><table class=" table-condensed"><thead><tr><th class="prev" style="visibility: visible;"><span class="glyphicon glyphicon-arrow-left"></span> </th><th colspan="5" class="switch">28 二月 2025</th><th class="next" style="visibility: visible;"><span class="glyphicon glyphicon-arrow-right"></span> </th></tr></thead><tbody><tr><td colspan="7"><span class="hour">0:00</span><span class="hour">1:00</span><span class="hour">2:00</span><span class="hour">3:00</span><span class="hour">4:00</span><span class="hour">5:00</span><span class="hour">6:00</span><span class="hour">7:00</span><span class="hour">8:00</span><span class="hour">9:00</span><span class="hour active">10:00</span><span class="hour">11:00</span><span class="hour">12:00</span><span class="hour">13:00</span><span class="hour">14:00</span><span class="hour">15:00</span><span class="hour">16:00</span><span class="hour">17:00</span><span class="hour">18:00</span><span class="hour">19:00</span><span class="hour">20:00</span><span class="hour">21:00</span><span class="hour">22:00</span><span class="hour">23:00</span></td></tr></tbody><tfoot><tr><th colspan="7" class="today" style="display: none;">今天</th></tr><tr><th colspan="7" class="clear" style="display: none;">清除</th></tr></tfoot></table></div><div class="datetimepicker-days" style="display: none;"><table class=" table-condensed"><thead><tr><th class="prev" style="visibility: visible;"><span class="glyphicon glyphicon-arrow-left"></span> </th><th colspan="5" class="switch">二月 2025</th><th class="next" style="visibility: visible;"><span class="glyphicon glyphicon-arrow-right"></span> </th></tr><tr><th class="dow">日</th><th class="dow">一</th><th class="dow">二</th><th class="dow">三</th><th class="dow">四</th><th class="dow">五</th><th class="dow">六</th></tr></thead><tbody><tr><td class="day old">26</td><td class="day old">27</td><td class="day old">28</td><td class="day old">29</td><td class="day old">30</td><td class="day old">31</td><td class="day">1</td></tr><tr><td class="day">2</td><td class="day">3</td><td class="day">4</td><td class="day">5</td><td class="day">6</td><td class="day">7</td><td class="day">8</td></tr><tr><td class="day">9</td><td class="day">10</td><td class="day">11</td><td class="day">12</td><td class="day">13</td><td class="day">14</td><td class="day">15</td></tr><tr><td class="day">16</td><td class="day">17</td><td class="day">18</td><td class="day">19</td><td class="day">20</td><td class="day">21</td><td class="day">22</td></tr><tr><td class="day">23</td><td class="day">24</td><td class="day">25</td><td class="day">26</td><td class="day">27</td><td class="day active">28</td><td class="day new">1</td></tr><tr><td class="day new">2</td><td class="day new">3</td><td class="day new">4</td><td class="day new">5</td><td class="day new">6</td><td class="day new">7</td><td class="day new">8</td></tr></tbody><tfoot><tr><th colspan="7" class="today" style="display: none;">今天</th></tr><tr><th colspan="7" class="clear" style="display: none;">清除</th></tr></tfoot></table></div><div class="datetimepicker-months" style="display: none;"><table class="table-condensed"><thead><tr><th class="prev" style="visibility: visible;"><span class="glyphicon glyphicon-arrow-left"></span> </th><th colspan="5" class="switch">2025</th><th class="next" style="visibility: visible;"><span class="glyphicon glyphicon-arrow-right"></span> </th></tr></thead><tbody><tr><td colspan="7"><span class="month">一月</span><span class="month active">二月</span><span class="month">三月</span><span class="month">四月</span><span class="month">五月</span><span class="month">六月</span><span class="month">七月</span><span class="month">八月</span><span class="month">九月</span><span class="month">十月</span><span class="month">十一月</span><span class="month">十二月</span></td></tr></tbody><tfoot><tr><th colspan="7" class="today" style="display: none;">今天</th></tr><tr><th colspan="7" class="clear" style="display: none;">清除</th></tr></tfoot></table></div><div class="datetimepicker-years" style="display: block;"><table class="table-condensed"><thead><tr><th class="prev" style="visibility: visible;"><span class="glyphicon glyphicon-arrow-left"></span> </th><th colspan="5" class="switch">2020-2029</th><th class="next" style="visibility: visible;"><span class="glyphicon glyphicon-arrow-right"></span> </th></tr></thead><tbody><tr><td colspan="7"><span class="year ">2019</span><span class="year">2020</span><span class="year">2021</span><span class="year">2022</span><span class="year">2023</span><span class="year">2024</span><span class="year active">2025</span><span class="year">2026</span><span class="year">2027</span><span class="year">2028</span><span class="year">2029</span><span class="year ">2030</span></td></tr></tbody><tfoot><tr><th colspan="7" class="today" style="display: none;">今天</th></tr><tr><th colspan="7" class="clear" style="display: none;">清除</th></tr></tfoot></table></div></div></body></html>
